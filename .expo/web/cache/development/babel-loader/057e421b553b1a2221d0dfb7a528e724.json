{"ast":null,"code":"var PrintOnlineOrder = function PrintOnlineOrder(_ref) {\n  var _storeDetails$address, _e$line_items;\n  var newItems = _ref.newItems,\n    storeDetails = _ref.storeDetails;\n  var CleanupOps = function CleanupOps(metaList) {\n    var opsArray = [];\n    metaList.forEach(function (op) {\n      var arrContaingMe = opsArray.filter(function (filterOp) {\n        return filterOp.key === op.key;\n      });\n      if (arrContaingMe.length > 0) {\n        opsArray.forEach(function (opsArrItem, index) {\n          if (opsArrItem.key === op.key) {\n            opsArray[index].vals.push(op.value);\n          }\n        });\n      } else {\n        opsArray.push({\n          key: op.key,\n          vals: [op.value]\n        });\n      }\n    });\n    return opsArray;\n  };\n  var e = newItems[0];\n  var printData = [];\n  var dateString = e.date_created;\n\n  printData.push(\"\\x1B\" + \"\\x40\",\n  \"\\x1B\" + \"\\x61\" + \"\\x31\",\n  storeDetails.name, \"\\x0A\", ((_storeDetails$address = storeDetails.address) == null ? void 0 : _storeDetails$address.label) + \"\\x0A\", storeDetails.website + \"\\x0A\",\n  storeDetails.phoneNumber + \"\\x0A\",\n  dateString + \"\\x0A\", \"\\x0A\", \"Online Order\" + \"\\x0A\",\n  \"Transaction ID \" + e.number + \"\\x0A\", \"\\x0A\", \"\\x0A\", \"\\x0A\", \"\\x1B\" + \"\\x61\" + \"\\x30\");\n\n  (_e$line_items = e.line_items) == null ? void 0 : _e$line_items.map(function (cartItem) {\n    printData.push(\"\\x0A\");\n    printData.push(\"Name: \" + cartItem.name);\n    printData.push(\"\\x0A\");\n    printData.push(\"Quantity: \" + cartItem.quantity);\n    printData.push(\"\\x0A\");\n    printData.push(\"Price: $\" + cartItem.price);\n    printData.push(\"\\x0A\");\n    if (cartItem.meta) {\n      CleanupOps(cartItem.meta).map(function (returnedItem) {\n        printData.push(returnedItem.key + \" : \");\n        printData.push(\"\\x0A\");\n        returnedItem.vals.map(function (val, index) {\n          printData.push(\"\" + val);\n          printData.push(\"\\x0A\");\n          if (index >= 0 && index < returnedItem.vals.length - 1) {\n            printData.push(\", \");\n          }\n        });\n        printData.push(\"\\x0A\");\n      });\n    } else {\n      printData.push(\"\\x0A\" + \"\\x0A\");\n    }\n  });\n  printData.push(\"\\x0A\");\n  printData.push(\"\\x0A\");\n  printData.push(\"Customer Details:\");\n  printData.push(\"\\x0A\");\n  printData.push(\"Address: \" + e.shipping.address_1);\n  printData.push(\"\\x0A\");\n  printData.push(\"City: \" + e.shipping.city);\n  printData.push(\"\\x0A\");\n  printData.push(\"Zip/Postal Code: \" + e.shipping.postcode);\n  printData.push(\"\\x0A\");\n  printData.push(\"Province/State: \" + e.shipping.state);\n  printData.push(\"\\x0A\");\n  printData.push(\"Name: \" + e.shipping.first_name + \" \" + e.shipping.last_name);\n  printData.push(\"\\x0A\");\n  printData.push(\"Phone Number: \" + e.billing.phone);\n  printData.push(\"\\x0A\");\n  e.shipping_lines.map(function (line) {\n    printData.push(\"Shipping Method: \" + line.method_title);\n    printData.push(\"\\x0A\");\n  });\n  if (e.customer_note) {\n    printData.push(\"Customer Note: \" + e.customer_note);\n    printData.push(\"\\x0A\");\n  }\n  printData.push(\"\\x0A\");\n  printData.push(\"\\x0A\");\n  printData.push(\"\\x0A\", \"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\" + \"\\x0A\", \"\\x0A\" + \"\\x0A\", \"Payment Method: \" + e.payment_method_title + \"\\x0A\" + \"\\x0A\", \"Total Including (\" + (storeDetails.taxRate ? storeDetails.taxRate : \"13\") + \"% Tax): \" + \"$\" + e.total + \"\\x0A\" + \"\\x0A\", \"------------------------------------------\" + \"\\x0A\", \"\\x0A\",\n  \"\\x0A\",\n  \"\\x0A\",\n  \"\\x0A\",\n  \"\\x0A\",\n  \"\\x0A\");\n\n  printData.push(\"\\x1D\" + \"\\x56\" + \"\\x00\");\n  var qz = require(\"qz-tray\");\n  qz.websocket.connect().then(function () {\n    var config = qz.configs.create(storeDetails.comSelected);\n    return qz.print(config, printData);\n  }).then(qz.websocket.disconnect).catch(function (err) {\n    console.error(err);\n  });\n};\nexport default PrintOnlineOrder;","map":{"version":3,"names":["PrintOnlineOrder","newItems","storeDetails","CleanupOps","metaList","opsArray","forEach","op","arrContaingMe","filter","filterOp","key","length","opsArrItem","index","vals","push","value","e","printData","dateString","date_created","name","address","label","website","phoneNumber","number","line_items","map","cartItem","quantity","price","meta","returnedItem","val","shipping","address_1","city","postcode","state","first_name","last_name","billing","phone","shipping_lines","line","method_title","customer_note","payment_method_title","taxRate","total","qz","require","websocket","connect","then","config","configs","create","comSelected","print","disconnect","catch","err","console","error"],"sources":["/Users/peterputros/Desktop/PosMate/navigation/PrintOnlineOrder.tsx"],"sourcesContent":["import { View, Text } from \"react-native\";\nimport React from \"react\";\nimport { tz } from \"moment\";\n\nconst PrintOnlineOrder = ({ newItems, storeDetails }) => {\n  const CleanupOps = (metaList) => {\n    const opsArray = [];\n\n    metaList.forEach((op) => {\n      const arrContaingMe = opsArray.filter(\n        (filterOp) => filterOp.key === op.key\n      );\n\n      if (arrContaingMe.length > 0) {\n        opsArray.forEach((opsArrItem, index) => {\n          if (opsArrItem.key === op.key) {\n            opsArray[index].vals.push(op.value);\n          }\n        });\n      } else {\n        opsArray.push({ key: op.key, vals: [op.value] });\n      }\n    });\n    return opsArray;\n  };\n\n\n    const e = newItems[0];\n    const printData = [];\n    const dateString = e.date_created;\n    // const newDate = new Date(dateString + \"Z\");\n    // const targetTimezone = Intl.DateTimeFormat().resolvedOptions().timeZone;\n    // const resultDate = tz(newDate)\n    //   .tz(targetTimezone, true)\n    //   .format(\"dddd, MMMM Do YYYY, h:mm:ss a z\");\n\n    printData.push(\n      \"\\x1B\" + \"\\x40\", // init\n      \"\\x1B\" + \"\\x61\" + \"\\x31\", // center align\n      storeDetails.name,\n      \"\\x0A\",\n      storeDetails.address?.label + \"\\x0A\",\n      storeDetails.website + \"\\x0A\", // text and line break\n      storeDetails.phoneNumber + \"\\x0A\", // text and line break\n      dateString + \"\\x0A\",\n      \"\\x0A\",\n      \"Online Order\" + \"\\x0A\", // text and line break\n      `Transaction ID ${e.number}` + \"\\x0A\",\n      \"\\x0A\",\n      \"\\x0A\",\n      \"\\x0A\",\n      \"\\x1B\" + \"\\x61\" + \"\\x30\" // left align\n    );\n\n    e.line_items?.map((cartItem) => {\n      printData.push(\"\\x0A\");\n      printData.push(`Name: ${cartItem.name}`);\n      printData.push(\"\\x0A\");\n      printData.push(`Quantity: ${cartItem.quantity}`);\n      printData.push(\"\\x0A\");\n      printData.push(`Price: $${cartItem.price}`);\n      printData.push(\"\\x0A\");\n\n      if (cartItem.meta) {\n        CleanupOps(cartItem.meta).map((returnedItem) => {\n          printData.push(`${returnedItem.key} : `);\n          printData.push(\"\\x0A\");\n          returnedItem.vals.map((val, index) => {\n            printData.push(`${val}`);\n            printData.push(\"\\x0A\");\n            if (index >= 0 && index < returnedItem.vals.length - 1) {\n              printData.push(\", \");\n            }\n          });\n          printData.push(\"\\x0A\");\n        });\n      } else {\n        printData.push(\"\\x0A\" + \"\\x0A\");\n      }\n    });\n\n    printData.push(\"\\x0A\");\n    printData.push(\"\\x0A\");\n    printData.push(`Customer Details:`);\n    printData.push(\"\\x0A\");\n    printData.push(`Address: ${e.shipping.address_1}`);\n    printData.push(\"\\x0A\");\n    printData.push(`City: ${e.shipping.city}`);\n    printData.push(\"\\x0A\");\n    printData.push(`Zip/Postal Code: ${e.shipping.postcode}`);\n    printData.push(\"\\x0A\");\n    printData.push(`Province/State: ${e.shipping.state}`);\n    printData.push(\"\\x0A\");\n    printData.push(`Name: ${e.shipping.first_name} ${e.shipping.last_name}`);\n    printData.push(\"\\x0A\");\n    printData.push(`Phone Number: ${e.billing.phone}`);\n    printData.push(\"\\x0A\");\n    e.shipping_lines.map((line) => {\n      printData.push(`Shipping Method: ${line.method_title}`);\n      printData.push(\"\\x0A\");\n    });\n    if (e.customer_note) {\n      printData.push(`Customer Note: ${e.customer_note}`);\n      printData.push(\"\\x0A\");\n    }\n    printData.push(\"\\x0A\");\n    printData.push(\"\\x0A\");\n\n    printData.push(\n      \"\\x0A\",\n      \"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\" + \"\\x0A\",\n      \"\\x0A\" + \"\\x0A\",\n      \"Payment Method: \" + e.payment_method_title + \"\\x0A\" + \"\\x0A\",\n      `Total Including (${\n        storeDetails.taxRate ? storeDetails.taxRate : \"13\"\n      }% Tax): ` +\n        \"$\" +\n        e.total +\n        \"\\x0A\" +\n        \"\\x0A\",\n      \"------------------------------------------\" + \"\\x0A\",\n      \"\\x0A\", // line break\n      \"\\x0A\", // line break\n      \"\\x0A\", // line break\n      \"\\x0A\", // line break\n      \"\\x0A\", // line break\n      \"\\x0A\" // line break\n    );\n\n    printData.push(\"\\x1D\" + \"\\x56\" + \"\\x00\");\n\n    const qz = require(\"qz-tray\");\n    qz.websocket\n      .connect()\n      .then(function () {\n        const config = qz.configs.create(storeDetails.comSelected);\n        return qz.print(config, printData);\n      })\n      .then(qz.websocket.disconnect)\n      .catch(function (err) {\n        console.error(err);\n      });\n};\n\nexport default PrintOnlineOrder;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}