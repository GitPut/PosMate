{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}import FlatList from\"react-native-web/dist/exports/FlatList\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Text from\"react-native-web/dist/exports/Text\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import View from\"react-native-web/dist/exports/View\";import React,{useRef,useState}from\"react\";import{Button,TextInput}from\"@react-native-material/core\";import DropDown from\"./DropDown\";import{userStoreState}from\"../state/state\";import{updateData}from\"../state/firebaseFunctions\";import OptionView from\"./OptionView\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var AddProduct=function AddProduct(_ref){var route=_ref.route,navigation=_ref.navigation;var _ref2=route.params?route.params:{existingProduct:null,existingProductIndex:null},existingProduct=_ref2.existingProduct,existingProductIndex=_ref2.existingProductIndex;var catalog=userStoreState.use();var _useState=useState(existingProduct?existingProduct:{name:null,price:null,catagory:null,options:[],description:null}),_useState2=_slicedToArray(_useState,2),newProduct=_useState2[0],setnewProduct=_useState2[1];var newProductOptions=useRef(existingProduct?existingProduct.options:[]);var _useState3=useState(0),_useState4=_slicedToArray(_useState3,2),indexOn=_useState4[0],setindexOn=_useState4[1];function handleDataUpdate(copyProductData){if(copyProductData){updateData(_toConsumableArray(catalog.categories),[].concat(_toConsumableArray(catalog.products),[copyProductData]));navigation.goBack();}else if(existingProduct){var copy=structuredClone(catalog.products);var newProductUseRef=_objectSpread(_objectSpread({},newProduct),{},{options:newProductOptions.current});copy[existingProductIndex]=newProductUseRef;updateData(_toConsumableArray(catalog.categories),copy);navigation.goBack();}else{updateData(_toConsumableArray(catalog.categories),[].concat(_toConsumableArray(catalog.products),[newProduct]));navigation.goBack();}}var OptionsAddingSection=function OptionsAddingSection(){return _jsxs(View,{children:[_jsx(FlatList,{getItemLayout:function getItemLayout(data,index){var _data$optionsList;return{length:index===indexOn?400*((_data$optionsList=data.optionsList)==null?void 0:_data$optionsList.length):100,offset:400*index,index:index};},data:newProduct.options,keyExtractor:function keyExtractor(item){var _item$id;return(_item$id=item.id)==null?void 0:_item$id.toString();},renderItem:function renderItem(_ref3){var item=_ref3.item,index=_ref3.index;return _jsx(OptionView,{item:item,index:index,newProduct:newProduct,setnewProduct:setnewProduct,newProductOptions:newProductOptions,indexOn:indexOn,setindexOn:setindexOn});}}),_jsx(Button,{title:\"Add Product Option\",onPress:function onPress(){newProductOptions.current.push({label:null,optionsList:[],selectedCaseKey:null,selectedCaseValue:null,numOfSelectable:null,id:Math.random().toString(36).substr(2,9),optionType:null});setnewProduct(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{options:newProductOptions.current});});setindexOn(newProductOptions.current.length-1);},style:{marginBottom:25}})]});};return _jsx(ScrollView,{style:{width:\"100%\",height:\"100%\",flex:1},contentContainerStyle:{width:\"93%\",alignSelf:\"center\",marginTop:25},children:_jsxs(_Fragment,{children:[_jsxs(View,{style:{flexDirection:\"row\",padding:20,justifyContent:\"space-between\",alignItems:\"center\"},children:[_jsx(TouchableOpacity,{onPress:function onPress(){return navigation.goBack();},children:_jsx(Text,{style:{marginBottom:25,fontWeight:\"700\",color:\"red\"},children:\"X\"})}),_jsx(TouchableOpacity,{onPress:function onPress(){var copy=structuredClone(newProduct);copy.name=copy.name+\" Copy\";handleDataUpdate(copy);},children:_jsx(Text,{style:{marginBottom:25,fontWeight:\"700\",color:\"red\"},children:\"Copy\"})}),_jsx(Text,{style:{marginBottom:25},children:\"AddProduct\"})]}),_jsx(TextInput,{placeholder:\"Enter Product Name\",onChangeText:function onChangeText(val){setnewProduct(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{name:val});});},value:newProduct.name,style:{marginBottom:25}}),_jsx(TextInput,{placeholder:\"Enter any other items that come with this\",onChangeText:function onChangeText(val){setnewProduct(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{description:val});});},style:{marginBottom:25},value:newProduct.description}),_jsx(TextInput,{placeholder:\"Enter Product Price\",onChangeText:function onChangeText(val){setnewProduct(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{price:val});});},style:{marginBottom:25},value:newProduct.price}),_jsx(DropDown,{label:\"Choose catagory\",options:catalog.categories,setValue:function setValue(val){setnewProduct(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{catagory:val});});},value:newProduct.catagory,style:{marginBottom:25}}),_jsx(OptionsAddingSection,{}),_jsx(Button,{title:\"Add/Save Product\",onPress:function onPress(){handleDataUpdate();},style:{marginBottom:25,marginTop:25,backgroundColor:\"lightgreen\"}})]})});};export default AddProduct;var styles=StyleSheet.create({});","map":{"version":3,"names":["React","useRef","useState","Button","TextInput","DropDown","userStoreState","updateData","OptionView","AddProduct","route","navigation","params","existingProduct","existingProductIndex","catalog","use","name","price","catagory","options","description","newProduct","setnewProduct","newProductOptions","indexOn","setindexOn","handleDataUpdate","copyProductData","categories","products","goBack","copy","structuredClone","newProductUseRef","current","OptionsAddingSection","data","index","length","optionsList","offset","item","id","toString","push","label","selectedCaseKey","selectedCaseValue","numOfSelectable","Math","random","substr","optionType","prevState","marginBottom","width","height","flex","alignSelf","marginTop","flexDirection","padding","justifyContent","alignItems","fontWeight","color","val","backgroundColor","styles","StyleSheet","create"],"sources":["/Users/peterputros/Desktop/PosMate/components/TestAdd.tsx"],"sourcesContent":["import {\n  FlatList,\n  ScrollView,\n  StyleSheet,\n  Text,\n  TouchableOpacity,\n  View,\n} from \"react-native\";\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport { Button, TextInput } from \"@react-native-material/core\";\nimport DropDown from \"./DropDown\";\nimport { userStoreState } from \"state/state\";\nimport { updateData } from \"state/firebaseFunctions\";\nimport OptionView from \"./OptionView\";\n\nconst AddProduct = ({ route, navigation }) => {\n  const { existingProduct, existingProductIndex } = route.params\n    ? route.params\n    : { existingProduct: null, existingProductIndex: null };\n\n  const catalog = userStoreState.use();\n  const [newProduct, setnewProduct] = useState(\n    existingProduct\n      ? existingProduct\n      : {\n          name: null,\n          price: null,\n          catagory: null,\n          options: [],\n          description: null,\n        }\n  );\n  const newProductOptions = useRef(\n    existingProduct ? existingProduct.options : []\n  );\n  const [indexOn, setindexOn] = useState(0);\n\n  // useEffect(() => {\n  //   //setTimeout(() => {\n  //   window.scrollTo({\n  //     top: currentY,\n  //     behavior: \"instant\",\n  //   });\n  //   //}, 500);\n  // }, [currentY]);\n\n  function handleDataUpdate(copyProductData) {\n    if (copyProductData) {\n      updateData(\n        [...catalog.categories],\n        [...catalog.products, copyProductData]\n      );\n      navigation.goBack();\n    } else if (existingProduct) {\n      let copy = structuredClone(catalog.products);\n      const newProductUseRef = {\n        ...newProduct,\n        options: newProductOptions.current,\n      };\n      copy[existingProductIndex] = newProductUseRef;\n      updateData([...catalog.categories], copy);\n      navigation.goBack();\n    } else {\n      updateData([...catalog.categories], [...catalog.products, newProduct]);\n      navigation.goBack();\n    }\n  }\n\n  const OptionsAddingSection = () => {\n    return (\n      <View>\n        <FlatList\n          // onLayout={() =>\n          //   window.scrollTo({\n          //     top: currentY,\n          //     behavior: \"instant\",\n          //   })\n          // }\n          getItemLayout={(data, index) => ({\n            length: index === indexOn ? 400 * data.optionsList?.length : 100,\n            offset: 400 * index,\n            index,\n          })}\n          data={newProduct.options}\n          keyExtractor={(item) => item.id?.toString()}\n          renderItem={({ item, index }) => (\n            <OptionView\n              item={item}\n              index={index}\n              newProduct={newProduct}\n              setnewProduct={setnewProduct}\n              newProductOptions={newProductOptions}\n              indexOn={indexOn}\n              setindexOn={setindexOn}\n            />\n          )}\n        />\n        <Button\n          title=\"Add Product Option\"\n          onPress={() => {\n            newProductOptions.current.push({\n              label: null,\n              optionsList: [],\n              selectedCaseKey: null,\n              selectedCaseValue: null,\n              numOfSelectable: null,\n              id: Math.random().toString(36).substr(2, 9),\n              optionType: null,\n            });\n            setnewProduct((prevState) => ({\n              ...prevState,\n              options: newProductOptions.current,\n            }));\n            setindexOn(newProductOptions.current.length - 1);\n          }}\n          style={{ marginBottom: 25 }}\n        />\n      </View>\n    );\n  };\n\n  return (\n    <ScrollView\n      style={{ width: \"100%\", height: \"100%\", flex: 1 }}\n      contentContainerStyle={{\n        width: \"93%\",\n        alignSelf: \"center\",\n        marginTop: 25,\n      }}\n    >\n      <>\n        <View\n          style={{\n            flexDirection: \"row\",\n            padding: 20,\n            justifyContent: \"space-between\",\n            alignItems: \"center\",\n          }}\n        >\n          <TouchableOpacity onPress={() => navigation.goBack()}>\n            <Text style={{ marginBottom: 25, fontWeight: \"700\", color: \"red\" }}>\n              X\n            </Text>\n          </TouchableOpacity>\n          <TouchableOpacity\n            onPress={() => {\n              let copy = structuredClone(newProduct);\n              copy.name = copy.name + \" Copy\";\n              handleDataUpdate(copy);\n            }}\n          >\n            <Text style={{ marginBottom: 25, fontWeight: \"700\", color: \"red\" }}>\n              Copy\n            </Text>\n          </TouchableOpacity>\n          <Text style={{ marginBottom: 25 }}>AddProduct</Text>\n        </View>\n        <TextInput\n          placeholder=\"Enter Product Name\"\n          onChangeText={(val) => {\n            setnewProduct((prevState) => ({ ...prevState, name: val }));\n          }}\n          value={newProduct.name}\n          style={{ marginBottom: 25 }}\n        />\n        <TextInput\n          placeholder=\"Enter any other items that come with this\"\n          onChangeText={(val) => {\n            setnewProduct((prevState) => ({ ...prevState, description: val }));\n          }}\n          style={{ marginBottom: 25 }}\n          value={newProduct.description}\n        />\n        <TextInput\n          placeholder=\"Enter Product Price\"\n          onChangeText={(val) => {\n            setnewProduct((prevState) => ({ ...prevState, price: val }));\n          }}\n          style={{ marginBottom: 25 }}\n          value={newProduct.price}\n        />\n        <DropDown\n          label=\"Choose catagory\"\n          options={catalog.categories}\n          setValue={(val) => {\n            setnewProduct((prevState) => ({ ...prevState, catagory: val }));\n          }}\n          value={newProduct.catagory}\n          style={{ marginBottom: 25 }}\n        />\n        <OptionsAddingSection />\n        <Button\n          title=\"Add/Save Product\"\n          onPress={() => {\n            handleDataUpdate();\n          }}\n          style={{\n            marginBottom: 25,\n            marginTop: 25,\n            backgroundColor: \"lightgreen\",\n          }}\n        />\n      </>\n    </ScrollView>\n  );\n};\n\nexport default AddProduct;\n\nconst styles = StyleSheet.create({});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}