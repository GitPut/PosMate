{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}import Modal from\"react-native-web/dist/exports/Modal\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Text from\"react-native-web/dist/exports/Text\";import View from\"react-native-web/dist/exports/View\";import useWindowDimensions from\"react-native-web/dist/exports/useWindowDimensions\";import Image from\"react-native-web/dist/exports/Image\";import ImageBackground from\"react-native-web/dist/exports/ImageBackground\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import ScrollView from\"react-native-web/dist/exports/ScrollView\";import FlatList from\"react-native-web/dist/exports/FlatList\";import Animated from\"react-native-web/dist/exports/Animated\";import TextInput from\"react-native-web/dist/exports/TextInput\";import React,{useEffect,useRef,useState}from\"react\";import{useParams}from\"react-router-dom\";import{db,storage}from\"../../state/firebaseConfig\";import TemplateImage from\"../../assets/template-background.jpg\";import GooglePlacesAutocomplete from\"react-google-places-autocomplete\";import{useHistory}from\"react-router-dom\";import Logo from\"../../assets/dpos-logo.png\";import CartItemEditable from\"../../components/cart/CartItemEditable\";import ProductListing from\"../../components/product/ProductListing\";import{addCartState,cartState,setCartState}from\"../../state/state\";var GOOGLE_API_KEY=\"AIzaSyDjx4LBIEDNRYKEt-0_TJ6jUcst4a2YON4\";import{CardElement,useStripe,useElements}from\"@stripe/react-stripe-js\";import{loadStripe}from\"@stripe/stripe-js\";import{Elements}from\"@stripe/react-stripe-js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var OrderPage=function OrderPage(){var history=useHistory();var _useParams=useParams(),urlEnding=_useParams.urlEnding;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),storeDetails=_useState2[0],setstoreDetails=_useState2[1];var _useState3=useState({categories:[],products:[]}),_useState4=_slicedToArray(_useState3,2),catalog=_useState4[0],setcatalog=_useState4[1];var height=useWindowDimensions().height;var width=useWindowDimensions().width;var _useState5=useState({delivery:null,address:null}),_useState6=_slicedToArray(_useState5,2),orderDetails=_useState6[0],setorderDetails=_useState6[1];var _useState7=useState(1),_useState8=_slicedToArray(_useState7,2),page=_useState8[0],setpage=_useState8[1];var _useState9=useState(true),_useState10=_slicedToArray(_useState9,2),loaderVisible=_useState10[0],setloaderVisible=_useState10[1];var fadeAnim=useRef(new Animated.Value(1)).current;useEffect(function(){db.collection(\"public\").where(\"urlEnding\",\"==\",urlEnding.toLowerCase()).get().then(function(querySnapshot){if(querySnapshot.empty){console.log(\"No existing online store\");history.push(\"/404\");}if(!querySnapshot.docs[0].data().onlineStoreActive){console.log(\"Store is not active\");history.push(\"/404\");}var products=[];setstoreDetails(_objectSpread(_objectSpread({},querySnapshot.docs[0].data().storeDetails),{},{docID:querySnapshot.docs[0].id,stripePublicKey:querySnapshot.docs[0].data().stripePublicKey}));querySnapshot.docs[0].ref.collection(\"products\").get().then(function(docs){if(!docs.empty){docs.forEach(function(element){products.push(element.data());});}}).catch(function(e){return console.log(\"Error has occured with db: \",e);});setcatalog({categories:querySnapshot.docs[0].data().categories,products:products,docID:querySnapshot.docs[0].id});fadeOut();});},[]);var fadeIn=function fadeIn(){Animated.timing(fadeAnim,{toValue:1,duration:500,useNativeDriver:false}).start();};var fadeOut=function fadeOut(){Animated.timing(fadeAnim,{toValue:0,duration:500,useNativeDriver:false}).start(function(){return setloaderVisible(false);});};var resetLoader=function resetLoader(){setloaderVisible(true);fadeIn();};return _jsxs(View,{style:{flex:1},children:[_jsx(ImageBackground,{source:storeDetails.bannerImage?storeDetails.bannerImage:TemplateImage,style:{height:height,width:width,flex:1,justifyContent:\"center\",alignItems:\"center\"},resizeMode:\"cover\",children:_jsxs(View,{style:{backgroundColor:\"rgba(0,0,0,0.5)\",width:\"100%\",height:\"100%\",justifyContent:\"center\",alignItems:\"center\"},children:[page===1&&_jsx(Page1,{storeDetails:storeDetails,setorderDetails:setorderDetails,orderDetails:orderDetails,setpage:setpage}),page===2&&_jsx(Page2,{storeDetails:storeDetails,setorderDetails:setorderDetails,orderDetails:orderDetails,setpage:setpage,catalog:catalog}),page===3&&storeDetails&&_jsx(Elements,{stripe:loadStripe(storeDetails.stripePublicKey),children:_jsx(Page3,{storeDetails:storeDetails,setorderDetails:setorderDetails,orderDetails:orderDetails,setpage:setpage,catalog:catalog})}),page===4&&_jsx(Page4,{})]})}),loaderVisible&&_jsx(Animated.View,{style:{alignItems:\"center\",justifyContent:\"center\",backgroundColor:\"white\",position:\"absolute\",opacity:fadeAnim,height:\"100%\",width:\"100%\"},children:_jsx(Image,{source:require(\"../../assets/loading.gif\"),style:{width:450,height:450,resizeMode:\"contain\"}})})]});};var Page1=function Page1(_ref){var storeDetails=_ref.storeDetails,setorderDetails=_ref.setorderDetails,orderDetails=_ref.orderDetails,setpage=_ref.setpage;function calculateDistance(lat1,lon1,lat2,lon2){var R=6371;var dLat=(lat2-lat1)*(Math.PI/180);var dLon=(lon2-lon1)*(Math.PI/180);var a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(lat1*(Math.PI/180))*Math.cos(lat2*(Math.PI/180))*Math.sin(dLon/2)*Math.sin(dLon/2);var c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));var distance=R*c;return distance;}function getLatLng(_x){return _getLatLng.apply(this,arguments);}function _getLatLng(){_getLatLng=_asyncToGenerator(function*(placeId){var response=yield fetch(\"https://us-central1-posmate-5fc0a.cloudfunctions.net/getLatLng\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({placeId:placeId})});try{var responseData=yield response.json();if(response.ok&&responseData.success){console.log(\"Success!\");return responseData.data;}else{console.error(responseData.message);}}catch(jsonError){console.error(\"Error parsing JSON response:\",jsonError);}});return _getLatLng.apply(this,arguments);}function calculateDistanceBetweenAddresses(_x2,_x3){return _calculateDistanceBetweenAddresses.apply(this,arguments);}function _calculateDistanceBetweenAddresses(){_calculateDistanceBetweenAddresses=_asyncToGenerator(function*(address1,address2){try{var _yield$getLatLng=yield getLatLng(address1),lat1=_yield$getLatLng.lat,lon1=_yield$getLatLng.lng;var _yield$getLatLng2=yield getLatLng(address2),lat2=_yield$getLatLng2.lat,lon2=_yield$getLatLng2.lng;var distance=calculateDistance(lat1,lon1,lat2,lon2);return distance;}catch(error){console.error(\"Error calculating distance:\",error);return null;}});return _calculateDistanceBetweenAddresses.apply(this,arguments);}return _jsxs(View,{children:[_jsx(View,{style:{padding:20,borderRadius:10,backgroundColor:\"rgba(255,255,255, 0.7)\",borderWidth:1,marginBottom:20},children:_jsxs(Text,{style:{fontSize:16},children:[\"Welcome to \",storeDetails.name]})}),_jsx(View,{style:{padding:20,borderRadius:10,backgroundColor:\"rgba(255,255,255, 0.7)\",borderWidth:1,marginBottom:20},children:_jsxs(Text,{style:{fontSize:16},children:[\"Would you like to order for Pickup\",\" \",storeDetails.acceptDelivery?\"or Delivery\":\"\"]})}),_jsxs(View,{style:{flexDirection:\"row\",justifyContent:\"space-between\",alignItems:\"center\"},children:[storeDetails.acceptDelivery&&_jsx(TouchableOpacity,{onPress:function onPress(){return setorderDetails(_objectSpread(_objectSpread({},orderDetails),{},{delivery:true}));},style:{padding:20,borderRadius:10,backgroundColor:\"rgba(255,255,255, 0.7)\",borderWidth:1,marginBottom:20,marginRight:20},children:_jsx(Text,{style:{fontSize:16},children:\"Delivery\"})}),_jsx(TouchableOpacity,{onPress:function onPress(){return setorderDetails(_objectSpread(_objectSpread({},orderDetails),{},{delivery:false,address:null}));},style:{padding:20,borderRadius:10,backgroundColor:\"rgba(255,255,255, 0.7)\",borderWidth:1,marginBottom:20},children:_jsx(Text,{style:{fontSize:16},children:\"Pickup\"})})]}),orderDetails.delivery&&_jsxs(View,{style:{padding:20,borderRadius:10,backgroundColor:\"rgba(255,255,255, 0.7)\",borderWidth:1,marginBottom:20},children:[_jsx(Text,{style:{fontSize:16},children:\"Please enter delivery address\"}),_jsx(GooglePlacesAutocomplete,{apiOptions:{region:\"CA\"},debounce:800,apiKey:GOOGLE_API_KEY,selectProps:{address:orderDetails.address,onChange:function onChange(address){return setorderDetails(_objectSpread(_objectSpread({},orderDetails),{},{address:address}));},defaultValue:orderDetails.address,menuPortalTarget:document.body,styles:{menuPortal:function menuPortal(base){return _objectSpread(_objectSpread({},base),{},{zIndex:9999});}}},renderSuggestions:function renderSuggestions(active,suggestions,onSelectSuggestion){return _jsx(\"div\",{children:suggestions.map(function(suggestion){return _jsx(\"div\",{className:\"suggestion\",onClick:function onClick(event){onSelectSuggestion(suggestion,event);},children:suggestion.description});})});}})]}),_jsx(TouchableOpacity,{onPress:function onPress(){if(orderDetails.delivery){if(!orderDetails.address){alert(\"Please enter a delivery address\");return;}calculateDistanceBetweenAddresses(storeDetails.address.value.reference,orderDetails.address.value.reference).then(function(distance){if(distance!==null){console.log(\"Distance between addresses: \"+distance.toFixed(2)+\" km\");if(storeDetails.deliveryRange){if(distance>parseFloat(storeDetails.deliveryRange)){alert(\"The delivery address is out of range\");}else{setpage(2);}}else{setpage(2);}}else{alert(\"Distance calculation between the store and your location failed. Please refresh page.\");}});}else{setpage(2);}},style:{padding:20,borderRadius:10,backgroundColor:\"rgba(255,255,255, 0.7)\",borderWidth:1,marginBottom:20,marginTop:20},children:_jsx(Text,{style:{fontSize:16},children:\"Next\"})})]});};var Page2=function Page2(_ref2){var _catalog$categories,_catalog$categories2;var storeDetails=_ref2.storeDetails,setorderDetails=_ref2.setorderDetails,orderDetails=_ref2.orderDetails,setpage=_ref2.setpage,catalog=_ref2.catalog;var _useWindowDimensions=useWindowDimensions(),height=_useWindowDimensions.height,width=_useWindowDimensions.width;var _useState11=useState(null),_useState12=_slicedToArray(_useState11,2),section=_useState12[0],setsection=_useState12[1];var _useState13=useState(0),_useState14=_slicedToArray(_useState13,2),cartSub=_useState14[0],setCartSub=_useState14[1];var cart=cartState.use();useEffect(function(){if(cart.length>0){var newVal=0;for(var i=0;i<cart.length;i++){try{if(cart[i].quantity>1){newVal+=parseFloat(cart[i].price)*cart[i].quantity;}else{newVal+=parseFloat(cart[i].price);}}catch(error){console.log(error);}}if(orderDetails.delivery){setCartSub(newVal+parseFloat(storeDetails.deliveryPrice));}else{setCartSub(newVal);}}else{setCartSub(0);}},[cart]);return _jsx(View,{style:{flex:1,height:\"100%\",width:\"100%\"},children:_jsxs(View,{style:{flexDirection:\"row\",height:\"100%\"},children:[_jsx(View,{style:{width:\"70%\",height:\"100%\"},children:_jsxs(View,{style:styles({height:height,width:width}).container,children:[_jsxs(View,{style:{backgroundColor:\"rgba(31,35,48,1)\",width:\"23%\",height:\"100%\",alignItems:\"center\",alignSelf:\"center\"},children:[_jsx(Image,{source:Logo,style:{width:200,height:160,resizeMode:\"contain\"}}),_jsx(ScrollView,{contentContainerStyle:{height:\"90%\",alignItems:\"center\"},children:(_catalog$categories=catalog.categories)==null?void 0:_catalog$categories.map(function(category,index){return _jsx(TouchableOpacity,{onPress:function onPress(){setsection(category);},style:{padding:10,marginBottom:20},children:_jsx(Text,{style:[section===null&&index===0&&{color:\"white\",fontWeight:\"700\",borderBottomWidth:1,borderBottomColor:\"white\"}||section===category&&{color:\"white\",fontWeight:\"700\",borderBottomWidth:1,borderBottomColor:\"white\"},{fontSize:16,color:\"white\"}],children:category})},index);})})]}),(_catalog$categories2=catalog.categories)==null?void 0:_catalog$categories2.map(function(category,index){var visible;if(section===null&&index===0){visible=true;}else if(section===category){visible=true;}else{visible=false;}return _jsx(MenuScreenInnerBlockLocal,{category:category,height:height,visible:visible,catalog:catalog},index);})]})}),_jsxs(View,{style:styles({height:height,width:width}).containerCart,children:[_jsx(View,{style:styles({height:height,width:width}).cartHeader,children:_jsx(Text,{style:{fontFamily:\"archivo-600\",color:\"rgba(255,255,255,1)\",fontSize:25},children:\"Order\"})}),_jsx(ScrollView,{contentContainerStyle:styles({height:height,width:width}).contentContainer,style:{marginBottom:10},children:_jsx(View,{children:(cart==null?void 0:cart.length)>0?cart==null?void 0:cart.map(function(cartItem,index){return _jsx(CartItemEditable,{cartItem:cartItem,index:index,removeAction:function removeAction(){console.log(\"Removing\");var local=structuredClone(cart);local.splice(index,1);setCartState(local);},decreaseAction:function decreaseAction(){var local=structuredClone(cart);local[index].quantity--;setCartState(local);},increaseAction:function increaseAction(){var local=structuredClone(cart);if(local[index].quantity){local[index].quantity++;}else{local[index].quantity=2;}setCartState(local);}},index);}):_jsxs(View,{style:{height:height*0.7,width:\"100%\",justifyContent:\"center\",alignItems:\"center\"},children:[_jsx(Text,{style:styles({height:height,width:width}).empty,children:\"Empty...\"}),_jsx(Text,{style:styles({height:height,width:width}).fillTheCart,children:\"Fill the Cart!\"})]})})}),_jsxs(View,{style:{justifyContent:\"space-around\",alignItems:\"center\",width:\"90%\",alignSelf:\"center\"},children:[orderDetails.delivery&&parseFloat(storeDetails.deliveryPrice)&&_jsxs(View,{style:{alignSelf:\"stretch\",flexDirection:\"row\",justifyContent:\"space-between\",alignItems:\"center\",marginBottom:2,paddingTop:5},children:[_jsx(Text,{style:{fontFamily:\"archivo-600\",color:\"rgba(74,74,74,1)\",fontSize:16,alignSelf:\"flex-start\"},children:\"Delivery\"}),_jsxs(Text,{style:[{fontFamily:\"archivo-600\",color:\"rgba(255,255,255,1)\",fontSize:20,alignSelf:\"flex-start\"},cartSub===0&&{opacity:0.5}],children:[\"$\",parseFloat(storeDetails.deliveryPrice).toFixed(2)]})]}),_jsxs(View,{style:{alignSelf:\"stretch\",flexDirection:\"row\",justifyContent:\"space-between\",alignItems:\"center\",marginBottom:2},children:[_jsx(Text,{style:{fontFamily:\"archivo-600\",color:\"rgba(74,74,74,1)\",fontSize:16,alignSelf:\"flex-start\"},children:\"Sub Total\"}),_jsxs(Text,{style:[{fontFamily:\"archivo-600\",color:\"rgba(255,255,255,1)\",fontSize:20,alignSelf:\"flex-start\"},cartSub===0&&{opacity:0.5}],children:[\"$\",cartSub.toFixed(2)]})]}),_jsxs(View,{style:{alignSelf:\"stretch\",flexDirection:\"row\",justifyContent:\"space-between\",alignItems:\"center\",marginBottom:2},children:[_jsx(Text,{style:{fontFamily:\"archivo-600\",color:\"rgba(74,74,74,1)\",fontSize:16,alignSelf:\"flex-start\"},children:\"Tax\"}),_jsxs(Text,{style:[{fontFamily:\"archivo-600\",color:\"rgba(255,255,255,1)\",fontSize:20,alignSelf:\"flex-start\"},cartSub===0&&{opacity:0.5}],children:[\"$\",(cartSub*(storeDetails.taxRate?storeDetails.taxRate/100:0.13)).toFixed(2)]})]}),_jsxs(View,{style:{alignSelf:\"stretch\",flexDirection:\"row\",justifyContent:\"space-between\",alignItems:\"center\",marginBottom:10},children:[_jsx(Text,{style:{fontFamily:\"archivo-600\",color:\"rgba(74,74,74,1)\",fontSize:16,alignSelf:\"flex-start\"},children:\"Total\"}),_jsxs(Text,{style:[{fontFamily:\"archivo-600\",color:\"rgba(255,255,255,1)\",fontSize:20,alignSelf:\"flex-start\"},cartSub===0&&{opacity:0.5}],children:[\"$\",(Math.ceil(cartSub*(storeDetails.taxRate?1+storeDetails.taxRate/100:1.13)*10)/10).toFixed(2)]})]}),_jsx(TouchableOpacity,{style:[styles({height:height,width:width}).bigButton,cartSub===0&&{opacity:0.5}],disabled:cart.length<1,onPress:function onPress(){var today=new Date();var transNum=Math.random().toString(36).substr(2,9);if(orderDetails.delivery){setorderDetails({date:today,transNum:transNum,total:(cartSub*(storeDetails.taxRate?1+storeDetails.taxRate/100:1.13)).toFixed(2),method:\"deliveryOrder\",online:true,cart:cart,customer:{name:orderDetails.name,phone:orderDetails.phone,address:orderDetails.address,email:orderDetails.email}});}else{setorderDetails({date:today,transNum:transNum,total:(cartSub*(storeDetails.taxRate?1+storeDetails.taxRate/100:1.13)).toFixed(2),method:\"pickupOrder\",online:true,cart:cart,customer:{name:orderDetails.name,phone:orderDetails.phone,email:orderDetails.email,address:null}});}setpage(3);},children:_jsx(Text,{style:styles({height:height,width:width}).btnTxt,children:\"Checkout\"})})]})]})]})});};var MenuScreenInnerBlockLocal=function MenuScreenInnerBlockLocal(_ref3){var _catalog$products;var category=_ref3.category,height=_ref3.height,visible=_ref3.visible,catalog=_ref3.catalog;var customSort=function customSort(a,b){var rankA=a.rank||Number.MAX_SAFE_INTEGER;var rankB=b.rank||Number.MAX_SAFE_INTEGER;return rankA-rankB;};if(((_catalog$products=catalog.products)==null?void 0:_catalog$products.length)>0){var renderItem=function renderItem(_ref4){var item=_ref4.item,index=_ref4.index;return _jsx(ProductDisplayBtnLocal,{product:item,productIndex:index,userUid:catalog.docID},index);};var keyExtractor=function keyExtractor(item){return item.id;};var getItemLayout=function getItemLayout(data,index){return{length:200,offset:200*index,index:index};};return _jsx(\"div\",{style:visible===false?{display:\"none\"}:{display:\"block\"},children:_jsx(FlatList,{style:{width:\"100%\",height:\"100%\"},contentContainerStyle:{flexDirection:\"row\",flexWrap:\"wrap\",justifyContent:\"space-between\",paddingLeft:50,paddingRight:50},data:catalog.products.filter(function(product){var isVisible=product.category===category&&!product.dontDisplayOnOnlineStore;return isVisible;}).sort(customSort),renderItem:renderItem,keyExtractor:keyExtractor,getItemLayout:getItemLayout})});}else{return _jsx(View,{style:{width:\"100%\",height:height*0.8,justifyContent:\"center\",alignItems:\"center\"},children:_jsx(Text,{style:{fontFamily:\"archivo-500\",color:\"rgba(74,74,74,1)\",fontSize:20},children:\"This category has no products...\"})});}};var ProductDisplayBtnLocal=function ProductDisplayBtnLocal(_ref5){var product=_ref5.product,productIndex=_ref5.productIndex,userUid=_ref5.userUid;var _useState15=useState(false),_useState16=_slicedToArray(_useState15,2),showProductScreen=_useState16[0],setshowProductScreen=_useState16[1];var xPos=useRef(new Animated.Value(-1000)).current;var shadowOpacity=useRef(new Animated.Value(0)).current;var _useState17=useState(),_useState18=_slicedToArray(_useState17,2),productImage=_useState18[0],setproductImage=_useState18[1];var cart=cartState.use();var _useWindowDimensions2=useWindowDimensions(),height=_useWindowDimensions2.height,width=_useWindowDimensions2.width;useEffect(function(){if(product.hasImage){storage.ref(userUid+\"/images/\"+product.id).getDownloadURL().then(function(url){setproductImage(url);});}},[]);var fadeIn=function fadeIn(){setshowProductScreen(true);Animated.timing(xPos,{toValue:0,duration:200,useNativeDriver:false}).start();Animated.timing(shadowOpacity,{toValue:1,duration:200,useNativeDriver:false}).start();};var fadeOut=function fadeOut(){Animated.timing(shadowOpacity,{toValue:0,duration:200,useNativeDriver:false}).start();Animated.timing(xPos,{toValue:-1000,duration:200,useNativeDriver:false}).start(function(){return setshowProductScreen(false);});};return _jsxs(TouchableOpacity,{onPress:function onPress(){if(product.options.length>0){fadeIn();}else{addCartState({name:product.name,price:product.price,description:product.description,options:[],extraDetails:null},cart);}},style:[styles({height:height,width:width}).touchable],children:[_jsx(\"div\",{style:{height:\"200px\",width:\"200px\",backgroundColor:\"rgba(0,0,0,0.5)\",borderRadius:\"3px\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\",backgroundImage:\"url(\"+productImage+\")\",backgroundSize:\"cover\",backgroundPosition:\"center\"},children:_jsx(View,{style:{height:\"100%\",width:\"100%\",backgroundColor:\"rgba(0,0,0,0.5)\",justifyContent:\"center\",alignItems:\"center\",borderRadius:3},children:_jsx(Text,{style:{fontFamily:\"archivo-500\",color:\"rgba(255,255,255,1)\",fontSize:15,textAlign:\"center\"},children:product.name})})}),showProductScreen&&_jsxs(Modal,{transparent:true,children:[_jsx(Animated.View,{style:{flex:1,justifyContent:\"flex-end\",alignItems:\"flex-start\",position:\"absolute\",height:\"100%\",width:\"100%\",bottom:0,left:xPos,zIndex:0},children:_jsx(View,{style:{height:\"100%\",width:\"70%\",borderTopRightRadius:3},children:_jsx(ProductListing,{product:product,goBack:function goBack(){return fadeOut();}})})}),_jsx(Animated.View,{style:{height:\"100%\",width:\"30%\",padding:20,shadowColor:\"rgba(0,0,0,1)\",shadowOffset:{width:-3,height:3},elevation:30,shadowOpacity:0.5,shadowRadius:5,position:\"absolute\",opacity:shadowOpacity,right:0,bottom:0}})]})]},productIndex);};var Page3=function Page3(_ref6){var storeDetails=_ref6.storeDetails,setorderDetails=_ref6.setorderDetails,orderDetails=_ref6.orderDetails,setpage=_ref6.setpage,catalog=_ref6.catalog;var _useWindowDimensions3=useWindowDimensions(),height=_useWindowDimensions3.height,width=_useWindowDimensions3.width;var stripe=useStripe();var elements=useElements();var _useState19=useState(\"cad\"),_useState20=_slicedToArray(_useState19,2),currency=_useState20[0],setCurrency=_useState20[1];var handleSubmit=function(){var _ref7=_asyncToGenerator(function*(event){event.preventDefault();if(!stripe||!elements){return;}var cardElement=elements.getElement(CardElement);var _yield$stripe$createT=yield stripe.createToken(cardElement),token=_yield$stripe$createT.token,error=_yield$stripe$createT.error;if(error){console.error(\"Error creating token:\",error);}else{console.log(\"Token:\",token);var response=yield fetch(\"https://us-central1-posmate-5fc0a.cloudfunctions.net/processPayment\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({token:token.id,amount:orderDetails.total,currency:currency,storeUID:storeDetails.docID,orderDetails:orderDetails})});try{var responseData=yield response.json();if(response.ok&&responseData.success){console.log(\"Payment processed successfully!\");setpage(4);}else{console.error(\"Payment processing failed. Server message:\",responseData.message);}}catch(jsonError){console.error(\"Error parsing JSON response:\",jsonError);}}});return function handleSubmit(_x4){return _ref7.apply(this,arguments);};}();return _jsxs(View,{style:{backgroundColor:\"white\",padding:20},children:[_jsx(Text,{children:\"Details\"}),_jsx(TextInput,{style:styles({height:height,width:width}).textInput,placeholder:\"Name\",value:orderDetails.customer.name,onChangeText:function onChangeText(text){return setorderDetails(_objectSpread(_objectSpread({},orderDetails),{},{customer:_objectSpread(_objectSpread({},orderDetails.customer),{},{name:text})}));}}),_jsx(TextInput,{style:styles({height:height,width:width}).textInput,placeholder:\"Phone Number\",value:orderDetails.customer.phone,onChangeText:function onChangeText(text){return setorderDetails(_objectSpread(_objectSpread({},orderDetails),{},{customer:_objectSpread(_objectSpread({},orderDetails.customer),{},{phone:text})}));}}),_jsx(TextInput,{style:styles({height:height,width:width}).textInput,placeholder:\"Email\",value:orderDetails.customer.email,onChangeText:function onChangeText(text){return setorderDetails(_objectSpread(_objectSpread({},orderDetails),{},{customer:_objectSpread(_objectSpread({},orderDetails.customer),{},{email:text})}));}}),_jsx(TextInput,{style:styles({height:height,width:width}).textInput,placeholder:\"Notes\",value:orderDetails.customer.note,onChangeText:function onChangeText(text){return setorderDetails(_objectSpread(_objectSpread({},orderDetails),{},{customer:_objectSpread(_objectSpread({},orderDetails.customer),{},{note:text})}));}}),_jsx(CardElement,{}),_jsx(TouchableOpacity,{onPress:function onPress(){return setpage(2);},style:{padding:20,borderRadius:10,backgroundColor:\"rgba(255,255,255, 0.7)\",borderWidth:1,marginBottom:20,marginTop:20},children:_jsx(Text,{style:{fontSize:16},children:\"Back\"})}),_jsx(TouchableOpacity,{onPress:handleSubmit,disabled:!stripe,style:{padding:20,borderRadius:10,backgroundColor:\"rgba(255,255,255, 0.7)\",borderWidth:1,marginBottom:20,marginTop:20},children:_jsx(Text,{style:{fontSize:16},children:\"Checkout\"})})]});};var Page4=function Page4(){return _jsx(View,{children:_jsx(Text,{children:\"Thank you for your order\"})});};export default OrderPage;var styles=function styles(props){return StyleSheet.create({container:{backgroundColor:\"white\",height:\"100%\",width:props.width*0.7,flexDirection:\"row\"},wrapper:{flexDirection:\"row\",flexWrap:\"wrap\",justifyContent:\"space-between\",paddingLeft:50,paddingRight:50},scrollview:{width:\"100%\"},containerCart:{height:\"100%\",width:\"30%\",padding:20,backgroundColor:\"rgba(31,35,48,1)\",borderTopRightRadius:0,borderBottomRightRadius:0,borderTopLeftRadius:2,borderBottomLeftRadius:2,shadowColor:\"rgba(0,0,0,1)\",shadowOffset:{width:-3,height:3},elevation:30,shadowOpacity:0.92,shadowRadius:5},contentContainer:{height:\"100%\",justifyContent:\"space-between\",width:\"100%\"},totalContainer:{height:\"14%\",paddingTop:10},cartHeader:{height:\"6%\",justifyContent:\"space-between\",width:\"100%\",flexDirection:\"row\",alignItems:\"center\",marginBottom:20},iconContainer:{alignItems:\"center\",justifyContent:\"center\",backgroundColor:\"rgba(41,44,56,1)\",borderRadius:15,width:50,height:50,margin:10},cashButton:{backgroundColor:\"rgba(51,81,243,1)\",borderRadius:30,borderTopRightRadius:0,borderBottomRightRadius:0,width:\"49.5%\",height:55,alignItems:\"center\",justifyContent:\"center\"},cardButton:{backgroundColor:\"rgba(51,81,243,1)\",borderRadius:30,borderTopRightRadius:30,borderBottomRightRadius:30,borderTopLeftRadius:0,borderBottomLeftRadius:0,width:\"49.5%\",height:55,alignItems:\"center\",justifyContent:\"center\"},btnTxt:{fontSize:20,color:\"white\"},totalTxt:{fontSize:16,marginBottom:5,color:\"rgba(255,255,255,1)\",fontWeight:\"600\"},totalTxtPrice:{fontSize:16,marginBottom:5,color:\"rgba(255,255,255,1)\",fontWeight:\"600\"},bigButton:{backgroundColor:\"rgba(51,81,243,1)\",borderRadius:30,width:\"98%\",height:55,alignItems:\"center\",justifyContent:\"center\"},innerTxt:{fontSize:13,marginBottom:10},headerTxt:{fontSize:15,fontWeight:\"600\"},empty:{fontFamily:\"archivo-600\",color:\"rgba(255,255,255,1)\",fontSize:20,opacity:0.44,marginTop:20},fillTheCart:{fontFamily:\"archivo-500\",color:\"rgba(74,74,74,1)\",fontSize:20},touchable:{margin:15,width:200,height:200,backgroundColor:\"rgba(125,126,132,1)\",alignItems:\"center\",justifyContent:\"center\",borderRadius:3},textInput:{backgroundColor:\"rgba(255,255,255,1)\",borderRadius:10,padding:10,marginBottom:10}});};","map":{"version":3,"names":["React","useEffect","useRef","useState","useParams","db","storage","TemplateImage","GooglePlacesAutocomplete","useHistory","Logo","CartItemEditable","ProductListing","addCartState","cartState","setCartState","GOOGLE_API_KEY","CardElement","useStripe","useElements","loadStripe","Elements","OrderPage","history","urlEnding","storeDetails","setstoreDetails","categories","products","catalog","setcatalog","height","useWindowDimensions","width","delivery","address","orderDetails","setorderDetails","page","setpage","loaderVisible","setloaderVisible","fadeAnim","Animated","Value","current","collection","where","toLowerCase","get","then","querySnapshot","empty","console","log","push","docs","data","onlineStoreActive","docID","id","stripePublicKey","ref","forEach","element","catch","e","fadeOut","fadeIn","timing","toValue","duration","useNativeDriver","start","resetLoader","flex","bannerImage","justifyContent","alignItems","backgroundColor","position","opacity","require","resizeMode","Page1","calculateDistance","lat1","lon1","lat2","lon2","R","dLat","Math","PI","dLon","a","sin","cos","c","atan2","sqrt","distance","getLatLng","placeId","response","fetch","method","headers","body","JSON","stringify","responseData","json","ok","success","error","message","jsonError","calculateDistanceBetweenAddresses","address1","address2","lat","lng","padding","borderRadius","borderWidth","marginBottom","fontSize","name","acceptDelivery","flexDirection","marginRight","region","onChange","defaultValue","menuPortalTarget","document","styles","menuPortal","base","zIndex","active","suggestions","onSelectSuggestion","map","suggestion","event","description","alert","value","reference","toFixed","deliveryRange","parseFloat","marginTop","Page2","section","setsection","cartSub","setCartSub","cart","use","length","newVal","i","quantity","price","deliveryPrice","container","alignSelf","category","index","color","fontWeight","borderBottomWidth","borderBottomColor","visible","containerCart","cartHeader","fontFamily","contentContainer","cartItem","local","structuredClone","splice","fillTheCart","paddingTop","taxRate","ceil","bigButton","today","Date","transNum","random","toString","substr","date","total","online","customer","phone","email","btnTxt","MenuScreenInnerBlockLocal","customSort","b","rankA","rank","Number","MAX_SAFE_INTEGER","rankB","renderItem","item","keyExtractor","getItemLayout","offset","display","flexWrap","paddingLeft","paddingRight","filter","product","isVisible","dontDisplayOnOnlineStore","sort","ProductDisplayBtnLocal","productIndex","userUid","showProductScreen","setshowProductScreen","xPos","shadowOpacity","productImage","setproductImage","hasImage","getDownloadURL","url","options","extraDetails","touchable","backgroundImage","backgroundSize","backgroundPosition","textAlign","bottom","left","borderTopRightRadius","shadowColor","shadowOffset","elevation","shadowRadius","right","Page3","stripe","elements","currency","setCurrency","handleSubmit","preventDefault","cardElement","getElement","createToken","token","amount","storeUID","textInput","text","note","Page4","props","StyleSheet","create","wrapper","scrollview","borderBottomRightRadius","borderTopLeftRadius","borderBottomLeftRadius","totalContainer","iconContainer","margin","cashButton","cardButton","totalTxt","totalTxtPrice","innerTxt","headerTxt"],"sources":["/Users/peterputros/Desktop/PosMate/pages/non-authed/OrderPage.tsx"],"sourcesContent":["import {\n  Modal,\n  StyleSheet,\n  Text,\n  View,\n  useWindowDimensions,\n  Image,\n  ImageBackground,\n  TouchableOpacity,\n  ScrollView,\n  FlatList,\n  Animated,\n  TextInput,\n} from \"react-native\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport { db, storage } from \"state/firebaseConfig\";\nimport TemplateImage from \"assets/template-background.jpg\";\nimport GooglePlacesAutocomplete from \"react-google-places-autocomplete\";\nimport { useHistory } from \"react-router-dom\";\nimport Logo from \"assets/dpos-logo.png\";\nimport CartItemEditable from \"components/cart/CartItemEditable\";\nimport ProductListing from \"components/product/ProductListing\";\nimport { addCartState, cartState, setCartState } from \"state/state\";\nconst GOOGLE_API_KEY = \"AIzaSyDjx4LBIEDNRYKEt-0_TJ6jUcst4a2YON4\";\nimport { CardElement, useStripe, useElements } from \"@stripe/react-stripe-js\";\nimport { loadStripe } from \"@stripe/stripe-js\";\nimport { Elements } from \"@stripe/react-stripe-js\";\n\nconst OrderPage = () => {\n  const history = useHistory();\n  const { urlEnding } = useParams();\n  const [storeDetails, setstoreDetails] = useState({});\n  const [catalog, setcatalog] = useState({\n    categories: [],\n    products: [],\n  });\n  const height = useWindowDimensions().height;\n  const width = useWindowDimensions().width;\n  const [orderDetails, setorderDetails] = useState({\n    delivery: null,\n    address: null,\n  });\n  const [page, setpage] = useState(1);\n  const [loaderVisible, setloaderVisible] = useState(true);\n  const fadeAnim = useRef(new Animated.Value(1)).current;\n\n  useEffect(() => {\n    db.collection(\"public\")\n      .where(\"urlEnding\", \"==\", urlEnding.toLowerCase())\n      .get()\n      .then((querySnapshot) => {\n        if (querySnapshot.empty) {\n          console.log(\"No existing online store\");\n          //send them to a 404 page\n          history.push(\"/404\");\n        }\n\n        if (!querySnapshot.docs[0].data().onlineStoreActive) {\n          console.log(\"Store is not active\");\n          //send them to a 404 page\n          history.push(\"/404\");\n        }\n\n        const products = [];\n\n        setstoreDetails({\n          ...querySnapshot.docs[0].data().storeDetails,\n          docID: querySnapshot.docs[0].id,\n          stripePublicKey: querySnapshot.docs[0].data().stripePublicKey,\n        });\n\n        querySnapshot.docs[0].ref\n          .collection(\"products\")\n          .get()\n          .then((docs) => {\n            if (!docs.empty) {\n              docs.forEach((element) => {\n                products.push(element.data());\n              });\n            }\n          })\n          .catch((e) => console.log(\"Error has occured with db: \", e));\n\n        setcatalog({\n          categories: querySnapshot.docs[0].data().categories,\n          products: products,\n          docID: querySnapshot.docs[0].id,\n        });\n\n        fadeOut();\n      });\n  }, []);\n\n  const fadeIn = () => {\n    // Will change fadeAnim value to 0 in 3 seconds\n    Animated.timing(fadeAnim, {\n      toValue: 1,\n      duration: 500,\n      useNativeDriver: false,\n    }).start();\n  };\n\n  const fadeOut = () => {\n    // Will change fadeAnim value to 0 in 3 seconds\n    Animated.timing(fadeAnim, {\n      toValue: 0,\n      duration: 500,\n      useNativeDriver: false,\n    }).start(() => setloaderVisible(false));\n  };\n\n  const resetLoader = () => {\n    setloaderVisible(true);\n    fadeIn();\n  };\n\n  return (\n    <View style={{ flex: 1 }}>\n      <ImageBackground\n        source={\n          storeDetails.bannerImage ? storeDetails.bannerImage : TemplateImage\n        }\n        style={{\n          height: height,\n          width: width,\n          flex: 1,\n          justifyContent: \"center\",\n          alignItems: \"center\",\n        }}\n        resizeMode=\"cover\"\n      >\n        <View\n          style={{\n            backgroundColor: \"rgba(0,0,0,0.5)\",\n            width: \"100%\",\n            height: \"100%\",\n            justifyContent: \"center\",\n            alignItems: \"center\",\n          }}\n        >\n          {page === 1 && (\n            <Page1\n              storeDetails={storeDetails}\n              setorderDetails={setorderDetails}\n              orderDetails={orderDetails}\n              setpage={setpage}\n            />\n          )}\n          {page === 2 && (\n            <Page2\n              storeDetails={storeDetails}\n              setorderDetails={setorderDetails}\n              orderDetails={orderDetails}\n              setpage={setpage}\n              catalog={catalog}\n            />\n          )}\n          {page === 3 && storeDetails && (\n            <Elements stripe={loadStripe(storeDetails.stripePublicKey)}>\n              <Page3\n                storeDetails={storeDetails}\n                setorderDetails={setorderDetails}\n                orderDetails={orderDetails}\n                setpage={setpage}\n                catalog={catalog}\n              />\n            </Elements>\n          )}\n          {page === 4 && <Page4 />}\n        </View>\n      </ImageBackground>\n      {loaderVisible && (\n        <Animated.View\n          style={{\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            backgroundColor: \"white\",\n            position: \"absolute\",\n            opacity: fadeAnim,\n            height: \"100%\",\n            width: \"100%\",\n          }}\n        >\n          <Image\n            source={require(\"assets/loading.gif\")}\n            style={{ width: 450, height: 450, resizeMode: \"contain\" }}\n          />\n        </Animated.View>\n      )}\n    </View>\n  );\n};\n\nconst Page1 = ({ storeDetails, setorderDetails, orderDetails, setpage }) => {\n  ///\n\n  // Function to calculate distance between two points using Haversine formula\n  function calculateDistance(lat1, lon1, lat2, lon2) {\n    const R = 6371; // Radius of the Earth in km\n    const dLat = (lat2 - lat1) * (Math.PI / 180); // Convert degrees to radians\n    const dLon = (lon2 - lon1) * (Math.PI / 180);\n    const a =\n      Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n      Math.cos(lat1 * (Math.PI / 180)) *\n        Math.cos(lat2 * (Math.PI / 180)) *\n        Math.sin(dLon / 2) *\n        Math.sin(dLon / 2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n    const distance = R * c; // Distance in km\n    return distance;\n  }\n\n  // Function to get the latitude and longitude of an address using the Google Maps Geocoding API\n  async function getLatLng(placeId) {\n    const response = await fetch(\n      \"https://us-central1-posmate-5fc0a.cloudfunctions.net/getLatLng\",\n      {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({\n          placeId: placeId,\n        }),\n      }\n    );\n\n    try {\n      const responseData = await response.json();\n\n      if (response.ok && responseData.success) {\n        console.log(\"Success!\");\n        return responseData.data;\n      } else {\n        console.error(responseData.message);\n      }\n    } catch (jsonError) {\n      console.error(\"Error parsing JSON response:\", jsonError);\n    }\n  }\n\n  // Function to calculate distance between two addresses using Google Places API\n  async function calculateDistanceBetweenAddresses(address1, address2) {\n    try {\n      const { lat: lat1, lng: lon1 } = await getLatLng(address1);\n      const { lat: lat2, lng: lon2 } = await getLatLng(address2);\n      const distance = calculateDistance(lat1, lon1, lat2, lon2);\n      return distance;\n    } catch (error) {\n      console.error(\"Error calculating distance:\", error);\n      return null;\n    }\n  }\n\n  ///\n\n  return (\n    <View>\n      <View\n        style={{\n          padding: 20,\n          borderRadius: 10,\n          backgroundColor: \"rgba(255,255,255, 0.7)\",\n          borderWidth: 1,\n          marginBottom: 20,\n        }}\n      >\n        <Text style={{ fontSize: 16 }}>Welcome to {storeDetails.name}</Text>\n      </View>\n      <View\n        style={{\n          padding: 20,\n          borderRadius: 10,\n          backgroundColor: \"rgba(255,255,255, 0.7)\",\n          borderWidth: 1,\n          marginBottom: 20,\n        }}\n      >\n        <Text style={{ fontSize: 16 }}>\n          Would you like to order for Pickup{\" \"}\n          {storeDetails.acceptDelivery ? \"or Delivery\" : \"\"}\n        </Text>\n      </View>\n      <View\n        style={{\n          flexDirection: \"row\",\n          justifyContent: \"space-between\",\n          alignItems: \"center\",\n        }}\n      >\n        {storeDetails.acceptDelivery && (\n          <TouchableOpacity\n            onPress={() => setorderDetails({ ...orderDetails, delivery: true })}\n            style={{\n              padding: 20,\n              borderRadius: 10,\n              backgroundColor: \"rgba(255,255,255, 0.7)\",\n              borderWidth: 1,\n              marginBottom: 20,\n              marginRight: 20,\n            }}\n          >\n            <Text style={{ fontSize: 16 }}>Delivery</Text>\n          </TouchableOpacity>\n        )}\n        <TouchableOpacity\n          onPress={() =>\n            setorderDetails({ ...orderDetails, delivery: false, address: null })\n          }\n          style={{\n            padding: 20,\n            borderRadius: 10,\n            backgroundColor: \"rgba(255,255,255, 0.7)\",\n            borderWidth: 1,\n            marginBottom: 20,\n          }}\n        >\n          <Text style={{ fontSize: 16 }}>Pickup</Text>\n        </TouchableOpacity>\n      </View>\n      {orderDetails.delivery && (\n        <View\n          style={{\n            padding: 20,\n            borderRadius: 10,\n            backgroundColor: \"rgba(255,255,255, 0.7)\",\n            borderWidth: 1,\n            marginBottom: 20,\n          }}\n        >\n          <Text style={{ fontSize: 16 }}>Please enter delivery address</Text>\n          <GooglePlacesAutocomplete\n            apiOptions={{\n              region: \"CA\",\n            }}\n            debounce={800}\n            apiKey={GOOGLE_API_KEY}\n            // onSelect={handleAddress}\n            selectProps={{\n              address: orderDetails.address,\n              onChange: (address) =>\n                setorderDetails({ ...orderDetails, address }),\n              defaultValue: orderDetails.address,\n              menuPortalTarget: document.body,\n              styles: {\n                menuPortal: (base) => ({ ...base, zIndex: 9999 }),\n              },\n            }}\n            renderSuggestions={(active, suggestions, onSelectSuggestion) => (\n              <div>\n                {suggestions.map((suggestion) => (\n                  <div\n                    className=\"suggestion\"\n                    onClick={(event) => {\n                      onSelectSuggestion(suggestion, event);\n                    }}\n                  >\n                    {suggestion.description}\n                  </div>\n                ))}\n              </div>\n            )}\n          />\n        </View>\n      )}\n      <TouchableOpacity\n        onPress={() => {\n          if (orderDetails.delivery) {\n            if (!orderDetails.address) {\n              alert(\"Please enter a delivery address\");\n              return;\n            }\n            calculateDistanceBetweenAddresses(\n              storeDetails.address.value.reference,\n              orderDetails.address.value.reference\n            ).then((distance) => {\n              if (distance !== null) {\n                console.log(\n                  `Distance between addresses: ${distance.toFixed(2)} km`\n                );\n                if (storeDetails.deliveryRange) {\n                  if (distance > parseFloat(storeDetails.deliveryRange)) {\n                    alert(\"The delivery address is out of range\");\n                  } else {\n                    setpage(2);\n                  }\n                } else {\n                  setpage(2);\n                }\n              } else {\n                alert(\n                  \"Distance calculation between the store and your location failed. Please refresh page.\"\n                );\n              }\n            });\n          } else {\n            setpage(2);\n          }\n        }}\n        style={{\n          padding: 20,\n          borderRadius: 10,\n          backgroundColor: \"rgba(255,255,255, 0.7)\",\n          borderWidth: 1,\n          marginBottom: 20,\n          marginTop: 20,\n        }}\n      >\n        <Text style={{ fontSize: 16 }}>Next</Text>\n      </TouchableOpacity>\n    </View>\n  );\n};\n\nconst Page2 = ({\n  storeDetails,\n  setorderDetails,\n  orderDetails,\n  setpage,\n  catalog,\n}) => {\n  const { height, width } = useWindowDimensions();\n  const [section, setsection] = useState(null);\n  const [cartSub, setCartSub] = useState(0);\n  const cart = cartState.use();\n\n  useEffect(() => {\n    if (cart.length > 0) {\n      let newVal = 0;\n      for (let i = 0; i < cart.length; i++) {\n        try {\n          if (cart[i].quantity > 1) {\n            newVal += parseFloat(cart[i].price) * cart[i].quantity;\n            // console.log(\"Cart item quantity \", cart[i].quantity);\n          } else {\n            newVal += parseFloat(cart[i].price);\n          }\n        } catch (error) {\n          console.log(error);\n        }\n      }\n      if (orderDetails.delivery) {\n        setCartSub(newVal + parseFloat(storeDetails.deliveryPrice));\n      } else {\n        setCartSub(newVal);\n      }\n    } else {\n      setCartSub(0);\n    }\n  }, [cart]);\n\n  return (\n    <View style={{ flex: 1, height: \"100%\", width: \"100%\" }}>\n      <View style={{ flexDirection: \"row\", height: \"100%\" }}>\n        <View style={{ width: \"70%\", height: \"100%\" }}>\n          <View style={styles({ height, width }).container}>\n            <View\n              style={{\n                backgroundColor: \"rgba(31,35,48,1)\",\n                width: \"23%\",\n                height: \"100%\",\n                alignItems: \"center\",\n                alignSelf: \"center\",\n              }}\n            >\n              <Image\n                source={Logo}\n                style={{ width: 200, height: 160, resizeMode: \"contain\" }}\n              />\n              <ScrollView\n                contentContainerStyle={{\n                  height: \"90%\",\n                  alignItems: \"center\",\n                }}\n              >\n                {catalog.categories?.map((category, index) => {\n                  return (\n                    <TouchableOpacity\n                      key={index}\n                      onPress={() => {\n                        setsection(category);\n                      }}\n                      style={{ padding: 10, marginBottom: 20 }}\n                    >\n                      <Text\n                        style={[\n                          (section === null &&\n                            index === 0 && {\n                              color: \"white\",\n                              fontWeight: \"700\",\n                              borderBottomWidth: 1,\n                              borderBottomColor: \"white\",\n                            }) ||\n                            (section === category && {\n                              color: \"white\",\n                              fontWeight: \"700\",\n                              borderBottomWidth: 1,\n                              borderBottomColor: \"white\",\n                            }),\n                          { fontSize: 16, color: \"white\" },\n                        ]}\n                      >\n                        {category}\n                      </Text>\n                    </TouchableOpacity>\n                  );\n                })}\n              </ScrollView>\n            </View>\n            {catalog.categories?.map((category, index) => {\n              let visible;\n\n              if (section === null && index === 0) {\n                visible = true;\n              } else if (section === category) {\n                visible = true;\n              } else {\n                visible = false;\n              }\n\n              return (\n                <MenuScreenInnerBlockLocal\n                  key={index}\n                  category={category}\n                  height={height}\n                  visible={visible}\n                  catalog={catalog}\n                />\n              );\n            })}\n          </View>\n        </View>\n        {/* Cart */}\n        <View style={styles({ height, width }).containerCart}>\n          <View style={styles({ height, width }).cartHeader}>\n            <Text\n              style={{\n                fontFamily: \"archivo-600\",\n                color: \"rgba(255,255,255,1)\",\n                fontSize: 25,\n              }}\n            >\n              Order\n            </Text>\n          </View>\n          <ScrollView\n            contentContainerStyle={styles({ height, width }).contentContainer}\n            style={{ marginBottom: 10 }}\n          >\n            <View>\n              {cart?.length > 0 ? (\n                cart?.map((cartItem, index) => (\n                  <CartItemEditable\n                    key={index}\n                    cartItem={cartItem}\n                    index={index}\n                    removeAction={() => {\n                      console.log(\"Removing\");\n                      const local = structuredClone(cart);\n                      local.splice(index, 1);\n                      setCartState(local);\n                    }}\n                    decreaseAction={() => {\n                      const local = structuredClone(cart);\n                      local[index].quantity--;\n                      setCartState(local);\n                    }}\n                    increaseAction={() => {\n                      const local = structuredClone(cart);\n                      if (local[index].quantity) {\n                        local[index].quantity++;\n                      } else {\n                        local[index].quantity = 2;\n                      }\n                      setCartState(local);\n                    }}\n                  />\n                ))\n              ) : (\n                <View\n                  style={{\n                    height: height * 0.7,\n                    width: \"100%\",\n                    justifyContent: \"center\",\n                    alignItems: \"center\",\n                  }}\n                >\n                  <Text style={styles({ height, width }).empty}>Empty...</Text>\n                  <Text style={styles({ height, width }).fillTheCart}>\n                    Fill the Cart!\n                  </Text>\n                </View>\n              )}\n            </View>\n          </ScrollView>\n          <View\n            style={{\n              justifyContent: \"space-around\",\n              alignItems: \"center\",\n              width: \"90%\",\n              alignSelf: \"center\",\n            }}\n          >\n            {orderDetails.delivery &&\n              parseFloat(storeDetails.deliveryPrice) && (\n                <View\n                  style={{\n                    alignSelf: \"stretch\",\n                    flexDirection: \"row\",\n                    justifyContent: \"space-between\",\n                    alignItems: \"center\",\n                    marginBottom: 2,\n                    paddingTop: 5,\n                  }}\n                >\n                  <Text\n                    style={{\n                      fontFamily: \"archivo-600\",\n                      color: \"rgba(74,74,74,1)\",\n                      fontSize: 16,\n                      alignSelf: \"flex-start\",\n                    }}\n                  >\n                    Delivery\n                  </Text>\n                  <Text\n                    style={[\n                      {\n                        fontFamily: \"archivo-600\",\n                        color: \"rgba(255,255,255,1)\",\n                        fontSize: 20,\n                        alignSelf: \"flex-start\",\n                      },\n                      cartSub === 0 && { opacity: 0.5 },\n                    ]}\n                  >\n                    ${parseFloat(storeDetails.deliveryPrice).toFixed(2)}\n                  </Text>\n                </View>\n              )}\n            <View\n              style={{\n                alignSelf: \"stretch\",\n                flexDirection: \"row\",\n                justifyContent: \"space-between\",\n                alignItems: \"center\",\n                marginBottom: 2,\n              }}\n            >\n              <Text\n                style={{\n                  fontFamily: \"archivo-600\",\n                  color: \"rgba(74,74,74,1)\",\n                  fontSize: 16,\n                  alignSelf: \"flex-start\",\n                }}\n              >\n                Sub Total\n              </Text>\n              <Text\n                style={[\n                  {\n                    fontFamily: \"archivo-600\",\n                    color: \"rgba(255,255,255,1)\",\n                    fontSize: 20,\n                    alignSelf: \"flex-start\",\n                  },\n                  cartSub === 0 && { opacity: 0.5 },\n                ]}\n              >\n                ${cartSub.toFixed(2)}\n              </Text>\n            </View>\n            <View\n              style={{\n                alignSelf: \"stretch\",\n                flexDirection: \"row\",\n                justifyContent: \"space-between\",\n                alignItems: \"center\",\n                marginBottom: 2,\n              }}\n            >\n              <Text\n                style={{\n                  fontFamily: \"archivo-600\",\n                  color: \"rgba(74,74,74,1)\",\n                  fontSize: 16,\n                  alignSelf: \"flex-start\",\n                }}\n              >\n                Tax\n              </Text>\n              <Text\n                style={[\n                  {\n                    fontFamily: \"archivo-600\",\n                    color: \"rgba(255,255,255,1)\",\n                    fontSize: 20,\n                    alignSelf: \"flex-start\",\n                  },\n                  cartSub === 0 && { opacity: 0.5 },\n                ]}\n              >\n                $\n                {(\n                  cartSub *\n                  (storeDetails.taxRate ? storeDetails.taxRate / 100 : 0.13)\n                ).toFixed(2)}\n              </Text>\n            </View>\n            <View\n              style={{\n                alignSelf: \"stretch\",\n                flexDirection: \"row\",\n                justifyContent: \"space-between\",\n                alignItems: \"center\",\n                marginBottom: 10,\n              }}\n            >\n              <Text\n                style={{\n                  fontFamily: \"archivo-600\",\n                  color: \"rgba(74,74,74,1)\",\n                  fontSize: 16,\n                  alignSelf: \"flex-start\",\n                }}\n              >\n                Total\n              </Text>\n              <Text\n                style={[\n                  {\n                    fontFamily: \"archivo-600\",\n                    color: \"rgba(255,255,255,1)\",\n                    fontSize: 20,\n                    alignSelf: \"flex-start\",\n                  },\n                  cartSub === 0 && { opacity: 0.5 },\n                ]}\n              >\n                $\n                {(\n                  Math.ceil(\n                    cartSub *\n                      (storeDetails.taxRate\n                        ? 1 + storeDetails.taxRate / 100\n                        : 1.13) *\n                      10\n                  ) / 10\n                ).toFixed(2)}\n              </Text>\n            </View>\n            <TouchableOpacity\n              style={[\n                styles({ height, width }).bigButton,\n                cartSub === 0 && { opacity: 0.5 },\n              ]}\n              disabled={cart.length < 1}\n              onPress={() => {\n                const today = new Date();\n                const transNum = Math.random().toString(36).substr(2, 9);\n\n                if (orderDetails.delivery) {\n                  setorderDetails({\n                    date: today,\n                    transNum: transNum,\n                    total: (\n                      cartSub *\n                      (storeDetails.taxRate\n                        ? 1 + storeDetails.taxRate / 100\n                        : 1.13)\n                    ).toFixed(2),\n                    method: \"deliveryOrder\",\n                    online: true,\n                    cart: cart,\n                    customer: {\n                      name: orderDetails.name,\n                      phone: orderDetails.phone,\n                      address: orderDetails.address,\n                      email: orderDetails.email,\n                    },\n                  });\n                } else {\n                  setorderDetails({\n                    date: today,\n                    transNum: transNum,\n                    total: (\n                      cartSub *\n                      (storeDetails.taxRate\n                        ? 1 + storeDetails.taxRate / 100\n                        : 1.13)\n                    ).toFixed(2),\n                    method: \"pickupOrder\",\n                    online: true,\n                    cart: cart,\n                    customer: {\n                      name: orderDetails.name,\n                      phone: orderDetails.phone,\n                      email: orderDetails.email,\n                      address: null,\n                    },\n                  });\n                }\n                setpage(3);\n              }}\n            >\n              <Text style={styles({ height, width }).btnTxt}>Checkout</Text>\n            </TouchableOpacity>\n          </View>\n        </View>\n        {/* Cart End */}\n      </View>\n    </View>\n  );\n};\n\nconst MenuScreenInnerBlockLocal = ({ category, height, visible, catalog }) => {\n  // Custom sorting function\n  const customSort = (a, b) => {\n    // Handle cases where one or both items don't have a rank\n    const rankA = a.rank || Number.MAX_SAFE_INTEGER;\n    const rankB = b.rank || Number.MAX_SAFE_INTEGER;\n\n    // Compare based on ranks\n    return rankA - rankB;\n  };\n\n  if (catalog.products?.length > 0) {\n    const renderItem = ({ item, index }) => (\n      <ProductDisplayBtnLocal\n        product={item}\n        productIndex={index}\n        key={index}\n        userUid={catalog.docID}\n      />\n    ); // Defined outside the render method\n    const keyExtractor = (item) => item.id; // Defined outside the render method\n    const getItemLayout = (data, index) => ({\n      length: 200,\n      offset: 200 * index,\n      index,\n    }); // Defined outside the render method\n\n    return (\n      <div\n        style={visible === false ? { display: \"none\" } : { display: \"block\" }}\n      >\n        <FlatList\n          style={{ width: \"100%\", height: \"100%\" }}\n          contentContainerStyle={{\n            flexDirection: \"row\",\n            flexWrap: \"wrap\",\n            justifyContent: \"space-between\",\n            paddingLeft: 50,\n            paddingRight: 50,\n          }}\n          data={catalog.products\n            .filter((product) => {\n              const isVisible =\n                product.category === category &&\n                !product.dontDisplayOnOnlineStore;\n              return isVisible;\n            })\n            .sort(customSort)}\n          renderItem={renderItem}\n          keyExtractor={keyExtractor}\n          getItemLayout={getItemLayout}\n        />\n      </div>\n    );\n  } else {\n    return (\n      <View\n        style={{\n          width: \"100%\",\n          height: height * 0.8,\n          justifyContent: \"center\",\n          alignItems: \"center\",\n        }}\n      >\n        <Text\n          style={{\n            fontFamily: \"archivo-500\",\n            color: \"rgba(74,74,74,1)\",\n            fontSize: 20,\n          }}\n        >\n          This category has no products...\n        </Text>\n      </View>\n    );\n  }\n};\n\nconst ProductDisplayBtnLocal = ({ product, productIndex, userUid }) => {\n  const [showProductScreen, setshowProductScreen] = useState(false);\n  const xPos = useRef(new Animated.Value(-1000)).current;\n  const shadowOpacity = useRef(new Animated.Value(0)).current;\n  const [productImage, setproductImage] = useState();\n  const cart = cartState.use();\n  const { height, width } = useWindowDimensions();\n\n  useEffect(() => {\n    if (product.hasImage) {\n      storage\n        .ref(userUid + \"/images/\" + product.id)\n        .getDownloadURL()\n        .then((url) => {\n          setproductImage(url);\n        });\n    }\n  }, []);\n\n  const fadeIn = () => {\n    // Will change xPos value to 0 in 3 seconds\n    setshowProductScreen(true);\n    Animated.timing(xPos, {\n      toValue: 0,\n      duration: 200,\n      useNativeDriver: false,\n    }).start();\n    Animated.timing(shadowOpacity, {\n      toValue: 1,\n      duration: 200,\n      useNativeDriver: false,\n    }).start();\n  };\n\n  const fadeOut = () => {\n    // Will change xPos value to 0 in 3 seconds\n    Animated.timing(shadowOpacity, {\n      toValue: 0,\n      duration: 200,\n      useNativeDriver: false,\n    }).start();\n    Animated.timing(xPos, {\n      toValue: -1000,\n      duration: 200,\n      useNativeDriver: false,\n    }).start(() => setshowProductScreen(false));\n  };\n\n  return (\n    <TouchableOpacity\n      key={productIndex}\n      onPress={() => {\n        if (product.options.length > 0) {\n          // navigation.navigate(\"Product Listing\", { product: product });\n          // setshowProductScreen(true);\n          fadeIn();\n        } else {\n          addCartState(\n            {\n              name: product.name,\n              price: product.price,\n              description: product.description,\n              options: [],\n              extraDetails: null,\n            },\n            cart\n          );\n        }\n      }}\n      style={[styles({ height, width }).touchable]}\n    >\n      <div\n        style={{\n          height: \"200px\",\n          width: \"200px\",\n          backgroundColor: \"rgba(0,0,0,0.5)\",\n          borderRadius: \"3px\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          alignItems: \"center\",\n          backgroundImage: `url(${productImage})`,\n          backgroundSize: \"cover\",\n          backgroundPosition: \"center\",\n        }}\n      >\n        <View\n          style={{\n            height: \"100%\",\n            width: \"100%\",\n            backgroundColor: \"rgba(0,0,0,0.5)\",\n            justifyContent: \"center\",\n            alignItems: \"center\",\n            borderRadius: 3,\n          }}\n        >\n          <Text\n            style={{\n              fontFamily: \"archivo-500\",\n              color: \"rgba(255,255,255,1)\",\n              fontSize: 15,\n              textAlign: \"center\",\n            }}\n          >\n            {product.name}\n          </Text>\n        </View>\n      </div>\n      {showProductScreen && (\n        <Modal transparent={true}>\n          <Animated.View\n            style={{\n              flex: 1,\n              justifyContent: \"flex-end\",\n              alignItems: \"flex-start\",\n              position: \"absolute\",\n              height: \"100%\",\n              width: \"100%\",\n              bottom: 0,\n              left: xPos,\n              zIndex: 0,\n            }}\n          >\n            <View\n              style={{\n                height: \"100%\",\n                width: \"70%\",\n                borderTopRightRadius: 3,\n              }}\n            >\n              <ProductListing\n                product={product}\n                // itemIndex={productIndex}\n                goBack={() => fadeOut()}\n              />\n            </View>\n          </Animated.View>\n          <Animated.View\n            style={{\n              height: \"100%\",\n              width: \"30%\",\n              padding: 20,\n              shadowColor: \"rgba(0,0,0,1)\",\n              shadowOffset: {\n                width: -3,\n                height: 3,\n              },\n              elevation: 30,\n              shadowOpacity: 0.5,\n              shadowRadius: 5,\n              position: \"absolute\",\n              opacity: shadowOpacity,\n              right: 0,\n              bottom: 0,\n            }}\n          />\n        </Modal>\n      )}\n    </TouchableOpacity>\n  );\n};\n\nconst Page3 = ({\n  storeDetails,\n  setorderDetails,\n  orderDetails,\n  setpage,\n  catalog,\n}) => {\n  const { height, width } = useWindowDimensions();\n\n  const stripe = useStripe();\n  const elements = useElements();\n\n  const [currency, setCurrency] = useState(\"cad\"); // Default to CAD\n\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n\n    if (!stripe || !elements) {\n      // Stripe.js has not loaded yet.\n      return;\n    }\n\n    const cardElement = elements.getElement(CardElement);\n\n    const { token, error } = await stripe.createToken(cardElement);\n\n    if (error) {\n      console.error(\"Error creating token:\", error);\n    } else {\n      console.log(\"Token:\", token);\n\n      // Send the token, amount, and currency to your Firebase Function to process the payment\n      const response = await fetch(\n        \"https://us-central1-posmate-5fc0a.cloudfunctions.net/processPayment\",\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({\n            token: token.id,\n            amount: orderDetails.total,\n            currency,\n            storeUID: storeDetails.docID,\n            orderDetails: orderDetails,\n          }),\n        }\n      );\n\n      try {\n        const responseData = await response.json();\n\n        if (response.ok && responseData.success) {\n          console.log(\"Payment processed successfully!\");\n          setpage(4);\n        } else {\n          console.error(\n            \"Payment processing failed. Server message:\",\n            responseData.message\n          );\n        }\n      } catch (jsonError) {\n        console.error(\"Error parsing JSON response:\", jsonError);\n      }\n    }\n  };\n\n  return (\n    <View style={{ backgroundColor: \"white\", padding: 20 }}>\n      <Text>Details</Text>\n      <TextInput\n        style={styles({ height, width }).textInput}\n        placeholder=\"Name\"\n        value={orderDetails.customer.name}\n        onChangeText={(text) =>\n          setorderDetails({\n            ...orderDetails,\n            customer: { ...orderDetails.customer, name: text },\n          })\n        }\n      />\n      <TextInput\n        style={styles({ height, width }).textInput}\n        placeholder=\"Phone Number\"\n        value={orderDetails.customer.phone}\n        onChangeText={(text) =>\n          setorderDetails({\n            ...orderDetails,\n            customer: { ...orderDetails.customer, phone: text },\n          })\n        }\n      />\n      <TextInput\n        style={styles({ height, width }).textInput}\n        placeholder=\"Email\"\n        value={orderDetails.customer.email}\n        onChangeText={(text) =>\n          setorderDetails({\n            ...orderDetails,\n            customer: { ...orderDetails.customer, email: text },\n          })\n        }\n      />\n      <TextInput\n        style={styles({ height, width }).textInput}\n        placeholder=\"Notes\"\n        value={orderDetails.customer.note}\n        onChangeText={(text) =>\n          setorderDetails({\n            ...orderDetails,\n            customer: { ...orderDetails.customer, note: text },\n          })\n        }\n      />\n      <CardElement />\n      <TouchableOpacity\n        onPress={() => setpage(2)}\n        style={{\n          padding: 20,\n          borderRadius: 10,\n          backgroundColor: \"rgba(255,255,255, 0.7)\",\n          borderWidth: 1,\n          marginBottom: 20,\n          marginTop: 20,\n        }}\n      >\n        <Text style={{ fontSize: 16 }}>Back</Text>\n      </TouchableOpacity>\n      <TouchableOpacity\n        onPress={handleSubmit}\n        disabled={!stripe}\n        style={{\n          padding: 20,\n          borderRadius: 10,\n          backgroundColor: \"rgba(255,255,255, 0.7)\",\n          borderWidth: 1,\n          marginBottom: 20,\n          marginTop: 20,\n        }}\n      >\n        <Text style={{ fontSize: 16 }}>Checkout</Text>\n      </TouchableOpacity>\n    </View>\n  );\n};\n\nconst Page4 = () => {\n  return (\n    <View>\n      <Text>Thank you for your order</Text>\n    </View>\n  );\n};\n\nexport default OrderPage;\n\nconst styles = (props) =>\n  StyleSheet.create({\n    container: {\n      backgroundColor: \"white\",\n      height: \"100%\",\n      width: props.width * 0.7,\n      flexDirection: \"row\",\n    },\n    wrapper: {\n      flexDirection: \"row\",\n      flexWrap: \"wrap\",\n      justifyContent: \"space-between\",\n      paddingLeft: 50,\n      paddingRight: 50,\n    },\n    scrollview: {\n      width: \"100%\",\n    },\n    containerCart: {\n      height: \"100%\",\n      width: \"30%\",\n      padding: 20,\n      backgroundColor: \"rgba(31,35,48,1)\",\n      borderTopRightRadius: 0,\n      borderBottomRightRadius: 0,\n      borderTopLeftRadius: 2,\n      borderBottomLeftRadius: 2,\n      shadowColor: \"rgba(0,0,0,1)\",\n      shadowOffset: {\n        width: -3,\n        height: 3,\n      },\n      elevation: 30,\n      shadowOpacity: 0.92,\n      shadowRadius: 5,\n    },\n    contentContainer: {\n      height: \"100%\",\n      justifyContent: \"space-between\",\n      width: \"100%\",\n    },\n    totalContainer: {\n      height: \"14%\",\n      paddingTop: 10,\n    },\n    cartHeader: {\n      height: \"6%\",\n      justifyContent: \"space-between\",\n      width: \"100%\",\n      flexDirection: \"row\",\n      alignItems: \"center\",\n      marginBottom: 20,\n    },\n    iconContainer: {\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      backgroundColor: \"rgba(41,44,56,1)\",\n      borderRadius: 15,\n      width: 50,\n      height: 50,\n      margin: 10,\n    },\n    cashButton: {\n      backgroundColor: \"rgba(51,81,243,1)\",\n      borderRadius: 30,\n      borderTopRightRadius: 0,\n      borderBottomRightRadius: 0,\n      width: \"49.5%\",\n      height: 55,\n      alignItems: \"center\",\n      justifyContent: \"center\",\n    },\n    cardButton: {\n      backgroundColor: \"rgba(51,81,243,1)\",\n      borderRadius: 30,\n      borderTopRightRadius: 30,\n      borderBottomRightRadius: 30,\n      borderTopLeftRadius: 0,\n      borderBottomLeftRadius: 0,\n      width: \"49.5%\",\n      height: 55,\n      alignItems: \"center\",\n      justifyContent: \"center\",\n    },\n    btnTxt: {\n      fontSize: 20,\n      color: \"white\",\n    },\n    totalTxt: {\n      fontSize: 16,\n      marginBottom: 5,\n      color: \"rgba(255,255,255,1)\",\n      fontWeight: \"600\",\n    },\n    totalTxtPrice: {\n      fontSize: 16,\n      marginBottom: 5,\n      color: \"rgba(255,255,255,1)\",\n      fontWeight: \"600\",\n    },\n    bigButton: {\n      backgroundColor: \"rgba(51,81,243,1)\",\n      borderRadius: 30,\n      width: \"98%\",\n      height: 55,\n      alignItems: \"center\",\n      justifyContent: \"center\",\n    },\n    innerTxt: {\n      fontSize: 13,\n      marginBottom: 10,\n    },\n    headerTxt: {\n      fontSize: 15,\n      fontWeight: \"600\",\n    },\n    empty: {\n      fontFamily: \"archivo-600\",\n      color: \"rgba(255,255,255,1)\",\n      fontSize: 20,\n      opacity: 0.44,\n      marginTop: 20,\n    },\n    fillTheCart: {\n      fontFamily: \"archivo-500\",\n      color: \"rgba(74,74,74,1)\",\n      fontSize: 20,\n    },\n    touchable: {\n      margin: 15,\n      width: 200,\n      height: 200,\n      backgroundColor: \"rgba(125,126,132,1)\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      borderRadius: 3,\n    },\n    textInput: {\n      backgroundColor: \"rgba(255,255,255,1)\",\n      borderRadius: 10,\n      padding: 10,\n      marginBottom: 10,\n    },\n  });\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}