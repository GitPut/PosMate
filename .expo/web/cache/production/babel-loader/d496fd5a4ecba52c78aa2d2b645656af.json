{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import Text from\"react-native-web/dist/exports/Text\";import View from\"react-native-web/dist/exports/View\";import React,{useState}from\"react\";import EditStoreDetails from\"../../components/EditStoreDetails\";import DropDown from\"../../components/DropDown\";import{auth,db}from\"../../state/firebaseConfig\";import{loadStripe}from\"@stripe/stripe-js\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var NewUserPayment=function NewUserPayment(){var _useState=useState(\"Pay $50 each month\"),_useState2=_slicedToArray(_useState,2),planType=_useState2[0],setplanType=_useState2[1];return _jsx(View,{style:styles.container,children:_jsxs(View,{style:styles.innerContainer,children:[_jsx(Text,{children:\"Welcome To Divine Pos\"}),_jsx(Text,{children:\"Please enter your busienss details to start!\"}),_jsxs(View,{style:{flexDirection:\"row\",justifyContent:\"space-between\",alignItems:\"center\",width:\"90%\"},children:[_jsx(Text,{children:\"Choose plan type\"}),_jsx(DropDown,{label:\"\",options:[\"Pay $50 each month\",\"Pay $480 Per Year/Each month @$40\",\"Test\"],setValue:setplanType,value:planType})]}),_jsx(EditStoreDetails,{customBtnLbl:\"Check Out\",customBtnExtraFunction:_asyncToGenerator(function*(){var priceId;if(planType===\"Pay $50 each month\"){priceId=\"price_1Mb2s4CIw3L7DOwI5PDx3qKx\";}else if(planType===\"Pay $480 Per Year/Each month @$40\"){priceId=\"price_1Mb2s4CIw3L7DOwIF00zPa4q\";}else if(planType===\"Test\"){priceId=\"price_1Mb4uSCIw3L7DOwI6exh9JBt\";}yield db.collection(\"users\").doc(auth.currentUser.uid).collection(\"checkout_sessions\").add({price:priceId,success_url:window.location.origin,cancel_url:window.location.origin}).then(function(docRef){docRef.onSnapshot(function(){var _ref2=_asyncToGenerator(function*(snap){var _snap$data=snap.data(),error=_snap$data.error,sessionId=_snap$data.sessionId;if(error){alert(\"An error occurred: \"+error.message);}if(sessionId){var stripe=yield loadStripe(\"pk_live_51MHqrvCIw3L7DOwI0ol9CTCSH7mQXTLKpxTWKzmwOY1MdKwaYwhdJq6WTpkWdBeql3sS44JmybynlRnaO2nSa1FK001dHiEOZO\");console.log(\"redirecting\");yield stripe.redirectToCheckout({sessionId:sessionId});}});return function(_x){return _ref2.apply(this,arguments);};}());});})})]})});};export default NewUserPayment;var styles=StyleSheet.create({container:{backgroundColor:\"rgba(31,35,48,1)\",width:\"100%\",height:\"100%\",justifyContent:\"center\",alignItems:\"center\"},innerContainer:{backgroundColor:\"white\",width:\"95%\",height:\"90%\",justifyContent:\"center\",alignItems:\"center\",borderRadius:6,padding:50}});","map":{"version":3,"names":["React","useState","EditStoreDetails","DropDown","auth","db","loadStripe","NewUserPayment","planType","setplanType","styles","container","innerContainer","flexDirection","justifyContent","alignItems","width","priceId","collection","doc","currentUser","uid","add","price","success_url","window","location","origin","cancel_url","then","docRef","onSnapshot","snap","data","error","sessionId","alert","message","stripe","console","log","redirectToCheckout","StyleSheet","create","backgroundColor","height","borderRadius","padding"],"sources":["/Users/peterputros/Desktop/PosMate/screens/authed/NewUserPayment.tsx"],"sourcesContent":["import { StyleSheet, Text, View } from \"react-native\";\nimport React, { useState } from \"react\";\nimport EditStoreDetails from \"components/EditStoreDetails\";\nimport DropDown from \"components/DropDown\";\nimport { auth, db } from \"state/firebaseConfig\";\nimport { loadStripe } from \"@stripe/stripe-js\";\n\nconst NewUserPayment = () => {\n  const [planType, setplanType] = useState(\"Pay $50 each month\");\n\n  return (\n    <View style={styles.container}>\n      <View style={styles.innerContainer}>\n        <Text>Welcome To Divine Pos</Text>\n        <Text>Please enter your busienss details to start!</Text>\n        <View\n          style={{\n            flexDirection: \"row\",\n            justifyContent: \"space-between\",\n            alignItems: \"center\",\n            width: \"90%\",\n          }}\n        >\n          <Text>Choose plan type</Text>\n          <DropDown\n            label=\"\"\n            options={[\n              \"Pay $50 each month\",\n              \"Pay $480 Per Year/Each month @$40\",\n              \"Test\",\n            ]}\n            setValue={setplanType}\n            value={planType}\n          />\n        </View>\n        <EditStoreDetails\n          customBtnLbl=\"Check Out\"\n          customBtnExtraFunction={async () => {\n            let priceId;\n            if (planType === \"Pay $50 each month\") {\n              priceId = \"price_1Mb2s4CIw3L7DOwI5PDx3qKx\";\n            } else if (planType === \"Pay $480 Per Year/Each month @$40\") {\n              priceId = \"price_1Mb2s4CIw3L7DOwIF00zPa4q\";\n            } else if (planType === \"Test\") {\n              priceId = \"price_1Mb4uSCIw3L7DOwI6exh9JBt\";\n            }\n            await db\n              .collection(\"users\")\n              .doc(auth.currentUser.uid)\n              .collection(\"checkout_sessions\")\n              .add({\n                price: priceId, // todo price Id from your products price in the Stripe Dashboard\n                success_url: window.location.origin, // return user to this screen on successful purchase\n                cancel_url: window.location.origin, // return user to this screen on failed purchase\n              })\n              .then((docRef) => {\n                // Wait for the checkoutSession to get attached by the extension\n                docRef.onSnapshot(async (snap) => {\n                  const { error, sessionId } = snap.data();\n                  if (error) {\n                    // Show an error to your customer and inspect\n                    // your Cloud Function logs in the Firebase console.\n                    alert(`An error occurred: ${error.message}`);\n                  }\n\n                  if (sessionId) {\n                    // We have a session, let's redirect to Checkout\n                    // Init Stripe\n                    const stripe = await loadStripe(\n                      \"pk_live_51MHqrvCIw3L7DOwI0ol9CTCSH7mQXTLKpxTWKzmwOY1MdKwaYwhdJq6WTpkWdBeql3sS44JmybynlRnaO2nSa1FK001dHiEOZO\" // todo enter your public stripe key here\n                    );\n                    console.log(`redirecting`);\n                    await stripe.redirectToCheckout({ sessionId });\n                  }\n                });\n              });\n          }}\n        />\n      </View>\n    </View>\n  );\n};\n\nexport default NewUserPayment;\n\nconst styles = StyleSheet.create({\n  container: {\n    backgroundColor: \"rgba(31,35,48,1)\",\n    width: \"100%\",\n    height: \"100%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  innerContainer: {\n    backgroundColor: \"white\",\n    width: \"95%\",\n    height: \"90%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    borderRadius: 6,\n    padding: 50,\n  },\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}