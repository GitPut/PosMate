{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}import React,{useEffect,useRef,useState}from\"react\";import{myDeviceDetailsState,setCustomersList,setDeviceIdState,setDeviceTreeState,setEmployeesState,setMyDeviceDetailsState,setOnlineStoreState,setStoreDetailState,setTrialDetailsState,setUserState,setUserStoreState,setWoocommerceState,storeDetailState,trialDetailsState,userState,woocommerceState}from\"../state/state\";import{auth,db}from\"../state/firebaseConfig\";import{updateFreeTrial}from\"../state/firebaseFunctions\";var tz=require(\"moment-timezone\");import NewUserPayment from\"../components/modals/NewUserPayment\";import Animated from\"react-native-web/dist/exports/Animated\";import Image from\"react-native-web/dist/exports/Image\";import*as Font from\"expo-font\";import TrialEnded from\"../components/modals/TrialEnded\";var qz=require(\"qz-tray\");import{BrowserRouter as Router,Route,Switch}from\"react-router-dom\";import AuthRoute from\"./authed/AuthRoute\";import NonAuthRoute from\"./non-authed/NonAuthRoute\";import useInterval from\"../components/functional/useInterval\";import ScrollToTop from\"../components/functional/ScrollToTop\";import PaymentUpdateNotification from\"../components/modals/PaymentUpdateNotification\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var RouteManager=function RouteManager(){var savedUserState=JSON.parse(localStorage.getItem(\"savedUserState\"));var userS=userState.use();var _useState=useState(true),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setloading=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),isNewUser=_useState4[0],setisNewUser=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),isSubscribed=_useState6[0],setisSubscribed=_useState6[1];var fadeAnim=useRef(new Animated.Value(1)).current;var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),viewVisible=_useState8[0],setviewVisible=_useState8[1];var _useState9=useState(null),_useState10=_slicedToArray(_useState9,2),isCanceled=_useState10[0],setisCanceled=_useState10[1];var trialDetails=trialDetailsState.use();var wooCredentials=woocommerceState.use();var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),wooOrders=_useState12[0],setwooOrders=_useState12[1];var storeDetails=storeDetailState.use();var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isWooError=_useState14[0],setisWooError=_useState14[1];var myDeviceDetails=myDeviceDetailsState.use();var _Font$useFonts=Font.useFonts({\"archivo-600\":require(\"../assets/fonts/Archivo-SemiBold.ttf\"),\"archivo-500\":require(\"../assets/fonts/Archivo-Regular.ttf\")}),_Font$useFonts2=_slicedToArray(_Font$useFonts,1),fontsLoaded=_Font$useFonts2[0];useEffect(function(){if(myDeviceDetails.docID&&userS){console.log(\"Listening for print requests\");db.collection(\"users\").doc(userS.uid).collection(\"devices\").doc(myDeviceDetails.docID).collection(\"printRequests\").onSnapshot(function(snapshot){if(snapshot.empty)return;snapshot.forEach(function(doc){var qz=require(\"qz-tray\");qz.websocket.connect().then(function(){var config=qz.configs.create(myDeviceDetails.printToPrinter);return qz.print(config,doc.data().printData);}).then(qz.websocket.disconnect).catch(function(err){alert(\"An error occured while trying to print. Try refreshing the page and trying again.\");});db.collection(\"users\").doc(userS.uid).collection(\"devices\").doc(myDeviceDetails.docID).collection(\"printRequests\").doc(doc.id).delete();});});}},[myDeviceDetails,userS]);var customSort=function customSort(a,b){var rankA=a.rank||Number.MAX_SAFE_INTEGER;var rankB=b.rank||Number.MAX_SAFE_INTEGER;return rankA-rankB;};useEffect(function(){setUserState(savedUserState);var unsubscribeAuthStateChanged=auth.onAuthStateChanged(function(user){fadeAnim.setValue(1);setviewVisible(true);if(user){localStorage.setItem(\"savedUserState\",true);setUserState(user);db.collection(\"users\").doc(user.uid).get().then(function(doc){import(\"../assets/plugins/fontawesome/css/fontawesome.min.css\");import(\"../assets/plugins/fontawesome/css/all.min.css\");import(\"../assets/css/bootstrap.min.css\");import(\"../assets/js/bootstrap.bundle.min.js\");import(\"../assets/css/font-awesome.min.css\");import(\"../assets/css/line-awesome.min.css\");import(\"../assets/css/style.css\");var products=[];var extraDevicesPayingFor=0;doc.ref.collection(\"products\").get().then(function(docs){if(!docs.empty){docs.forEach(function(element){products.push(element.data());});products.sort(customSort);}}).catch(function(e){return console.log(\"Error has occured with db products: \",e);});setUserStoreState({products:products.sort(customSort),categories:doc.data().categories?doc.data().categories:[]});if(doc.data().wooCredentials){setWoocommerceState(doc.data().wooCredentials);}if(doc.data().storeDetails){setStoreDetailState(doc.data().storeDetails);}doc.ref.collection(\"wooOrders\").get().then(function(docs){if(!docs.empty){docs.forEach(function(element){setwooOrders(function(prev){return[].concat(_toConsumableArray(prev),[element.data()]);});});}}).catch(function(e){return console.log(\"Error has occured with db wooorders: \",e);});doc.ref.collection(\"employees\").get().then(function(docs){if(!docs.empty){var localEmployees=[];docs.forEach(function(element){localEmployees.push(element.data());});setEmployeesState(localEmployees);}}).catch(function(e){return console.log(\"Error has occured with db employees: \",e);});doc.ref.collection(\"subscriptions\").get().then(function(docs){if(!docs.empty){docs.forEach(function(element){if(element.data().role===\"Test Plan\"){if(element.data().status===\"active\"){setisSubscribed(true);setisNewUser(false);if(doc.data().freeTrial){setTrialDetailsState({endDate:null,hasEnded:null});updateFreeTrial(null);}}else if(element.data().status===\"canceled\"){setisSubscribed(false);setisNewUser(false);setisCanceled(true);}else{setisSubscribed(false);setisNewUser(false);}}if(element.data().role===\"Pos Software Plan\"){if(element.data().status===\"active\"){setisSubscribed(true);setisNewUser(false);if(doc.data().freeTrial){setTrialDetailsState({endDate:null,hasEnded:null});updateFreeTrial(null);}}else if(element.data().status===\"canceled\"){setisSubscribed(false);setisNewUser(false);setisCanceled(true);}else{setisSubscribed(false);setisNewUser(false);}}if(element.data().role===\"Online Store\"){if(element.data().status===\"active\"){setOnlineStoreState({urlEnding:doc.data().urlEnding,onlineStoreActive:doc.data().onlineStoreActive,onlineStoreSetUp:doc.data().onlineStoreSetUp,stripePublicKey:doc.data().stripePublicKey,stripeSecretKey:doc.data().stripeSecretKey,paidStatus:\"active\"});}else if(element.data().status===\"canceled\"){db.collection(\"users\").doc(auth.currentUser.uid).update({onlineStoreActive:false});db.collection(\"public\").doc(auth.currentUser.uid).update({onlineStoreActive:false});setOnlineStoreState({urlEnding:doc.data().urlEnding,onlineStoreActive:false,onlineStoreSetUp:doc.data().onlineStoreSetUp,stripePublicKey:doc.data().stripePublicKey,stripeSecretKey:doc.data().stripeSecretKey,paidStatus:\"canceled\"});}else{db.collection(\"users\").doc(auth.currentUser.uid).update({onlineStoreActive:false});db.collection(\"public\").doc(auth.currentUser.uid).update({onlineStoreActive:false});setOnlineStoreState({urlEnding:doc.data().urlEnding,onlineStoreActive:false,onlineStoreSetUp:doc.data().onlineStoreSetUp,stripePublicKey:doc.data().stripePublicKey,stripeSecretKey:doc.data().stripeSecretKey,paidStatus:null});}}});var devicesAmount=docs.docs.filter(function(e){return e.data().role===\"Extra Device\"&&e.data().status===\"active\";}).length;extraDevicesPayingFor=devicesAmount;}else if(doc.data().freeTrial){setisSubscribed(true);setisNewUser(false);}else{setisNewUser(true);setisSubscribed(false);}}).catch(function(){return console.log(\"Error has occured with db extra devices\");});doc.ref.collection(\"customers\").get().then(function(docs){var newCustomerList=[];docs.forEach(function(element){newCustomerList.push(_objectSpread(_objectSpread({},element.data()),{},{id:element.id}));});setCustomersList(newCustomerList);}).catch(function(e){return console.log(\"Error has occured with db customers: \",e);});if(doc.data().freeTrial){setisNewUser(false);var firstDate=new Date(doc.data().freeTrial.seconds*1000);var today=new Date();if(firstDate<=today){setTrialDetailsState({endDate:doc.data().freeTrial,hasEnded:true});}else{setTrialDetailsState({endDate:doc.data().freeTrial,hasEnded:false});}}function getCookie(name){var match=document.cookie.match(new RegExp(\"(^| )\"+name+\"=([^;]+)\"));if(match)return match[2];}var deviceID=getCookie(\"deviceID\");if(!deviceID){var yourDeviceID=Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15);document.cookie=\"deviceID=\"+yourDeviceID+\"; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/\";setDeviceIdState(yourDeviceID);}else{setDeviceIdState(deviceID);}doc.ref.collection(\"devices\").get().then(function(docs){var devices=[];docs.forEach(function(element){devices.push(_objectSpread(_objectSpread({},element.data()),{},{docID:element.id}));if(element.data().id===deviceID){console.log(\"found device: \",element.data());setMyDeviceDetailsState(_objectSpread(_objectSpread({},element.data()),{},{docID:element.id}));}});setDeviceTreeState({devices:devices,extraDevicesPayingFor:extraDevicesPayingFor});});var unsub=db.collection(\"users\").doc(user.uid).onSnapshot(function(doc){setUserStoreState({products:products.sort(customSort),categories:doc.data().categories?doc.data().categories:[]});if(doc.data().wooCredentials){setWoocommerceState(doc.data().wooCredentials);}if(doc.data().storeDetails){setStoreDetailState(doc.data().storeDetails);}});setloading(false);fadeOut();return function(){unsub();};}).catch(function(e){return console.log(\"Error has occured with db users: \",e);});}else{localStorage.removeItem(\"savedUserState\");setUserState(null);setUserStoreState({products:null,categories:null});setisNewUser(false);setisSubscribed(false);setloading(false);}});return function(){unsubscribeAuthStateChanged();};},[savedUserState]);useInterval(function(){if(wooCredentials.useWoocommerce&&isSubscribed&&!isWooError&&myDeviceDetails.printOnlineOrders){var WooCommerceAPI=require(\"woocommerce-api\");var WooCommerce=new WooCommerceAPI({url:wooCredentials.apiUrl,consumerKey:wooCredentials.ck,consumerSecret:wooCredentials.cs,wpAPI:true,version:\"wc/v3\"});var page=1;var orders=[];var getOrders=function(){var _ref=_asyncToGenerator(function*(){var response=yield WooCommerce.getAsync(\"orders?page=\"+page+\"&per_page=100\");var data=JSON.parse(response.body);orders=[].concat(_toConsumableArray(orders),_toConsumableArray(data));if(data.length===100){page++;getOrders();}else{}});return function getOrders(){return _ref.apply(this,arguments);};}();getOrders().then(function(){if(JSON.stringify(orders)===JSON.stringify(wooOrders))return;var _loop=function _loop(index){var order=orders[index];var orderIndex=void 0;if(wooOrders.length>0){orderIndex=wooOrders.findIndex(function(e){return e.id===order.id;});}else{orderIndex=-1;}if(orderIndex===-1||!wooOrders[orderIndex].printed){var _storeDetails$address,_order$line_items;if(orderIndex===-1){db.collection(\"users\").doc(userS.uid).collection(\"wooOrders\").doc(order.id.toString()).set(_objectSpread(_objectSpread({},order),{},{printed:true})).then(function(){setwooOrders(function(prev){return[].concat(_toConsumableArray(prev),[_objectSpread(_objectSpread({},order),{},{printed:true})]);});wooOrders.push(_objectSpread(_objectSpread({},order),{},{printed:true}));}).catch(function(e){return console.log(\"Error has occured with db wooOrders print: \",e);});}else{db.collection(\"users\").doc(userS.uid).collection(\"wooOrders\").doc(order.id.toString()).update({printed:true}).then(function(){setwooOrders(function(prev){var newOrders=_toConsumableArray(prev);newOrders[orderIndex].printed=true;return newOrders;});wooOrders[index].printed=true;}).catch(function(e){return console.log(\"Error has occured with db wooOrder print second if: \",e);});}var CleanupOps=function CleanupOps(metaList){var opsArray=[];metaList.forEach(function(op){var arrContaingMe=opsArray.filter(function(filterOp){return filterOp.key===op.key;});if(arrContaingMe.length>0){opsArray.forEach(function(opsArrItem,index){if(opsArrItem.key===op.key){opsArray[index].vals.push(op.value);}});}else{opsArray.push({key:op.key,vals:[op.value]});}});return opsArray;};var printData=[];var dateString=order.date_created;var newDate=new Date(dateString+\"Z\");var targetTimezone=Intl.DateTimeFormat().resolvedOptions().timeZone;var resultDate=tz(newDate).tz(targetTimezone,true).format(\"dddd, MMMM Do YYYY, h:mm:ss a z\");printData.push(\"\\x1B\"+\"\\x40\",\"\\x1B\"+\"\\x61\"+\"\\x31\",storeDetails.name,\"\\x0A\",((_storeDetails$address=storeDetails.address)==null?void 0:_storeDetails$address.label)+\"\\x0A\",storeDetails.website+\"\\x0A\",storeDetails.phoneNumber+\"\\x0A\",resultDate+\"\\x0A\",\"\\x0A\",\"Online Order\"+\"\\x0A\",\"Transaction ID \"+order.number+\"\\x0A\",\"\\x0A\",\"\\x0A\",\"\\x0A\",\"\\x1B\"+\"\\x61\"+\"\\x30\");(_order$line_items=order.line_items)==null?void 0:_order$line_items.map(function(cartItem){printData.push(\"\\x0A\");printData.push(\"Name: \"+cartItem.name);printData.push(\"\\x0A\");printData.push(\"Quantity: \"+cartItem.quantity);printData.push(\"\\x0A\");printData.push(\"Price: $\"+cartItem.price);printData.push(\"\\x0A\");if(cartItem.meta){CleanupOps(cartItem.meta).map(function(returnedItem){printData.push(returnedItem.key+\" : \");printData.push(\"\\x0A\");returnedItem.vals.map(function(val,index){printData.push(\"\"+val);printData.push(\"\\x0A\");if(index>=0&&index<returnedItem.vals.length-1){printData.push(\", \");}});printData.push(\"\\x0A\");});}else{printData.push(\"\\x0A\"+\"\\x0A\");}});printData.push(\"\\x0A\");printData.push(\"\\x0A\");printData.push(\"Customer Details:\");printData.push(\"\\x0A\");printData.push(\"Address: \"+order.shipping.address_1);printData.push(\"\\x0A\");printData.push(\"City: \"+order.shipping.city);printData.push(\"\\x0A\");printData.push(\"Zip/Postal Code: \"+order.shipping.postcode);printData.push(\"\\x0A\");printData.push(\"Province/State: \"+order.shipping.state);printData.push(\"\\x0A\");printData.push(\"Name: \"+order.shipping.first_name+\" \"+order.shipping.last_name);printData.push(\"\\x0A\");printData.push(\"Phone Number: \"+order.billing.phone);printData.push(\"\\x0A\");order.shipping_lines.map(function(line){printData.push(\"Shipping Method: \"+line.method_title);printData.push(\"\\x0A\");});if(order.customer_note){printData.push(\"Customer Note: \"+order.customer_note);printData.push(\"\\x0A\");}printData.push(\"\\x0A\");printData.push(\"\\x0A\");printData.push(\"\\x0A\",\"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\"+\"\\x0A\",\"\\x0A\"+\"\\x0A\",\"Payment Method: \"+order.payment_method_title+\"\\x0A\"+\"\\x0A\",\"Total Including (\"+(storeDetails.taxRate?storeDetails.taxRate:\"13\")+\"% Tax): \"+\"$\"+order.total+\"\\x0A\"+\"\\x0A\",\"------------------------------------------\"+\"\\x0A\",\"\\x0A\",\"\\x0A\",\"\\x0A\",\"\\x0A\",\"\\x0A\",\"\\x0A\");printData.push(\"\\x1D\"+\"\\x56\"+\"\\x00\");var doublePrint=printData.concat(printData);qz.websocket.connect().then(function(){var config=qz.configs.create(myDeviceDetails.printToPrinter);return qz.print(config,doublePrint);}).then(qz.websocket.disconnect).catch(function(err){alert(\"An error occured while trying to print. Try refreshing the page and trying again.\");});}};for(var index=0;index<orders.length;index++){_loop(index);}}).catch(function(e){console.log(\"Error has occured when trying to get WooOrders: \",e);alert(\"There was an error connecting to your woocommerce store. Please refresh the page to try again.\");setisWooError(true);});}},10000);var fadeIn=function fadeIn(){Animated.timing(fadeAnim,{toValue:1,duration:500,useNativeDriver:false}).start();};var fadeOut=function fadeOut(){Animated.timing(fadeAnim,{toValue:0,duration:500,useNativeDriver:false}).start(function(){return setviewVisible(false);});};var resetLoader=function resetLoader(){setviewVisible(true);fadeIn();};var NavigationContent=function NavigationContent(){return _jsxs(_Fragment,{children:[isSubscribed&&_jsx(Route,{path:\"/\",component:AuthRoute}),trialDetails.hasEnded&&_jsx(TrialEnded,{resetLoader:resetLoader}),isNewUser&&_jsx(NewUserPayment,{resetLoader:resetLoader}),isCanceled&&!isSubscribed&&!isNewUser&&_jsx(PaymentUpdateNotification,{resetLoader:resetLoader,isCanceled:isCanceled})]});};return _jsxs(Router,{children:[_jsx(ScrollToTop,{}),_jsxs(Switch,{children:[userS&&_jsxs(_Fragment,{children:[_jsx(NavigationContent,{}),viewVisible&&_jsx(Animated.View,{style:{alignItems:\"center\",justifyContent:\"center\",backgroundColor:\"white\",position:\"absolute\",opacity:fadeAnim,height:\"100%\",width:\"100%\"},children:_jsx(Image,{source:require(\"../assets/loading.gif\"),style:{width:450,height:450,resizeMode:\"contain\"}})})]}),!userS&&!loading&&_jsx(Route,{path:\"/\",component:NonAuthRoute})]})]});};export default RouteManager;","map":{"version":3,"names":["React","useEffect","useRef","useState","myDeviceDetailsState","setCustomersList","setDeviceIdState","setDeviceTreeState","setEmployeesState","setMyDeviceDetailsState","setOnlineStoreState","setStoreDetailState","setTrialDetailsState","setUserState","setUserStoreState","setWoocommerceState","storeDetailState","trialDetailsState","userState","woocommerceState","auth","db","updateFreeTrial","tz","require","NewUserPayment","Font","TrialEnded","qz","BrowserRouter","Router","Route","Switch","AuthRoute","NonAuthRoute","useInterval","ScrollToTop","PaymentUpdateNotification","RouteManager","savedUserState","JSON","parse","localStorage","getItem","userS","use","loading","setloading","isNewUser","setisNewUser","isSubscribed","setisSubscribed","fadeAnim","Animated","Value","current","viewVisible","setviewVisible","isCanceled","setisCanceled","trialDetails","wooCredentials","wooOrders","setwooOrders","storeDetails","isWooError","setisWooError","myDeviceDetails","useFonts","fontsLoaded","docID","console","log","collection","doc","uid","onSnapshot","snapshot","empty","forEach","websocket","connect","then","config","configs","create","printToPrinter","print","data","printData","disconnect","catch","err","alert","id","delete","customSort","a","b","rankA","rank","Number","MAX_SAFE_INTEGER","rankB","unsubscribeAuthStateChanged","onAuthStateChanged","user","setValue","setItem","get","products","extraDevicesPayingFor","ref","docs","element","push","sort","e","categories","prev","localEmployees","role","status","freeTrial","endDate","hasEnded","urlEnding","onlineStoreActive","onlineStoreSetUp","stripePublicKey","stripeSecretKey","paidStatus","currentUser","update","devicesAmount","filter","length","newCustomerList","firstDate","Date","seconds","today","getCookie","name","match","document","cookie","RegExp","deviceID","yourDeviceID","Math","random","toString","substring","devices","unsub","fadeOut","removeItem","useWoocommerce","printOnlineOrders","WooCommerceAPI","WooCommerce","url","apiUrl","consumerKey","ck","consumerSecret","cs","wpAPI","version","page","orders","getOrders","response","getAsync","body","stringify","index","order","orderIndex","findIndex","printed","set","newOrders","CleanupOps","metaList","opsArray","op","arrContaingMe","filterOp","key","opsArrItem","vals","value","dateString","date_created","newDate","targetTimezone","Intl","DateTimeFormat","resolvedOptions","timeZone","resultDate","format","address","label","website","phoneNumber","number","line_items","map","cartItem","quantity","price","meta","returnedItem","val","shipping","address_1","city","postcode","state","first_name","last_name","billing","phone","shipping_lines","line","method_title","customer_note","payment_method_title","taxRate","total","doublePrint","concat","fadeIn","timing","toValue","duration","useNativeDriver","start","resetLoader","NavigationContent","alignItems","justifyContent","backgroundColor","position","opacity","height","width","resizeMode"],"sources":["/Users/peterputros/Desktop/PosMate/navigation/RouteManager.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport {\n  myDeviceDetailsState,\n  setCustomersList,\n  setDeviceIdState,\n  setDeviceTreeState,\n  setEmployeesState,\n  setMyDeviceDetailsState,\n  setOnlineStoreState,\n  setStoreDetailState,\n  setTrialDetailsState,\n  setUserState,\n  setUserStoreState,\n  setWoocommerceState,\n  storeDetailState,\n  trialDetailsState,\n  userState,\n  woocommerceState,\n} from \"state/state\";\nimport { auth, db } from \"state/firebaseConfig\";\nimport { logout, updateFreeTrial } from \"state/firebaseFunctions\";\nconst tz = require(\"moment-timezone\");\nimport NewUserPayment from \"components/modals/NewUserPayment\";\nimport { Animated, Image } from \"react-native\";\nimport * as Font from \"expo-font\";\nimport TrialEnded from \"components/modals/TrialEnded\";\nconst qz = require(\"qz-tray\");\n\nimport { BrowserRouter as Router, Route, Switch } from \"react-router-dom\";\nimport AuthRoute from \"./authed/AuthRoute\";\nimport NonAuthRoute from \"./non-authed/NonAuthRoute\";\nimport useInterval from \"components/functional/useInterval\";\nimport ScrollToTop from \"components/functional/ScrollToTop\";\nimport PaymentUpdateNotification from \"components/modals/PaymentUpdateNotification\";\n\nconst RouteManager = () => {\n  const savedUserState = JSON.parse(localStorage.getItem(\"savedUserState\"));\n  const userS = userState.use();\n  const [loading, setloading] = useState(true);\n  const [isNewUser, setisNewUser] = useState(null);\n  const [isSubscribed, setisSubscribed] = useState(null);\n  const fadeAnim = useRef(new Animated.Value(1)).current;\n  const [viewVisible, setviewVisible] = useState(true);\n  const [isCanceled, setisCanceled] = useState(null);\n  const trialDetails = trialDetailsState.use();\n  const wooCredentials = woocommerceState.use();\n  const [wooOrders, setwooOrders] = useState([]);\n  const storeDetails = storeDetailState.use();\n  const [isWooError, setisWooError] = useState(false);\n  const myDeviceDetails = myDeviceDetailsState.use();\n\n  const [fontsLoaded] = Font.useFonts({\n    \"archivo-600\": require(\"assets/fonts/Archivo-SemiBold.ttf\"),\n    \"archivo-500\": require(\"assets/fonts/Archivo-Regular.ttf\"),\n  });\n\n  useEffect(() => {\n    if (myDeviceDetails.docID && userS) {\n      console.log(\"Listening for print requests\");\n      db.collection(\"users\")\n        .doc(userS.uid)\n        .collection(\"devices\")\n        .doc(myDeviceDetails.docID)\n        .collection(\"printRequests\")\n        .onSnapshot((snapshot) => {\n          if (snapshot.empty) return;\n\n          snapshot.forEach((doc) => {\n            // console.log(\"Data to print recieved: \", doc.data().printData);\n\n            const qz = require(\"qz-tray\");\n            qz.websocket\n              .connect()\n              .then(function () {\n                const config = qz.configs.create(\n                  myDeviceDetails.printToPrinter\n                );\n                return qz.print(config, doc.data().printData);\n              })\n              .then(qz.websocket.disconnect)\n              .catch(function (err) {\n                // console.error(err);\n                alert(\n                  \"An error occured while trying to print. Try refreshing the page and trying again.\"\n                );\n              });\n            //print then delete\n\n            db.collection(\"users\")\n              .doc(userS.uid)\n              .collection(\"devices\")\n              .doc(myDeviceDetails.docID)\n              .collection(\"printRequests\")\n              .doc(doc.id)\n              .delete();\n          });\n        });\n    }\n  }, [myDeviceDetails, userS]);\n\n  const customSort = (a, b) => {\n    // Handle cases where one or both items don't have a rank\n    const rankA = a.rank || Number.MAX_SAFE_INTEGER;\n    const rankB = b.rank || Number.MAX_SAFE_INTEGER;\n\n    // Compare based on ranks\n    return rankA - rankB;\n  };\n\n  useEffect(() => {\n    setUserState(savedUserState);\n\n    const unsubscribeAuthStateChanged = auth.onAuthStateChanged((user) => {\n      fadeAnim.setValue(1);\n      setviewVisible(true);\n      if (user) {\n        localStorage.setItem(\"savedUserState\", true);\n        setUserState(user);\n\n        // let customers = localStorage.getItem(\"customers\");\n        // if (customers) {\n        //   customers = JSON.parse(customers);\n        // }\n\n        db.collection(\"users\")\n          .doc(user.uid)\n          .get()\n          .then((doc) => {\n            import(\"assets/plugins/fontawesome/css/fontawesome.min.css\");\n            import(\"assets/plugins/fontawesome/css/all.min.css\");\n            import(\"assets/css/bootstrap.min.css\");\n            import(\"assets/js/bootstrap.bundle.min.js\");\n            import(\"assets/css/font-awesome.min.css\");\n            import(\"assets/css/line-awesome.min.css\");\n            import(\"assets/css/style.css\");\n\n            const products = [];\n            let extraDevicesPayingFor = 0;\n\n            doc.ref\n              .collection(\"products\")\n              .get()\n              .then((docs) => {\n                if (!docs.empty) {\n                  docs.forEach((element) => {\n                    products.push(element.data());\n                  });\n                  products.sort(customSort);\n                }\n              })\n              .catch((e) =>\n                console.log(\"Error has occured with db products: \", e)\n              );\n\n            setUserStoreState({\n              products: products.sort(customSort),\n              categories: doc.data().categories ? doc.data().categories : [],\n            });\n\n            // setOnlineStoreState({\n            //   urlEnding: doc.data().urlEnding,\n            //   onlineStoreActive: doc.data().onlineStoreActive,\n            //   onlineStoreSetUp: doc.data().onlineStoreSetUp,\n            //   stripePublicKey: doc.data().stripePublicKey,\n            //   stripeSecretKey: doc.data().stripeSecretKey,\n            // });\n\n            if (doc.data().wooCredentials) {\n              setWoocommerceState(doc.data().wooCredentials);\n            }\n            if (doc.data().storeDetails) {\n              setStoreDetailState(doc.data().storeDetails);\n            }\n\n            doc.ref\n              .collection(\"wooOrders\")\n              .get()\n              .then((docs) => {\n                if (!docs.empty) {\n                  docs.forEach((element) => {\n                    setwooOrders((prev) => [...prev, element.data()]);\n                  });\n                }\n              })\n              .catch((e) =>\n                console.log(\"Error has occured with db wooorders: \", e)\n              );\n\n            doc.ref\n              .collection(\"employees\")\n              .get()\n              .then((docs) => {\n                if (!docs.empty) {\n                  const localEmployees = [];\n                  docs.forEach((element) => {\n                    localEmployees.push(element.data());\n                  });\n                  setEmployeesState(localEmployees);\n                }\n              })\n              .catch((e) =>\n                console.log(\"Error has occured with db employees: \", e)\n              );\n\n            doc.ref\n              .collection(\"subscriptions\")\n              .get()\n              .then((docs) => {\n                if (!docs.empty) {\n                  docs.forEach((element) => {\n                    if (element.data().role === \"Test Plan\") {\n                      if (element.data().status === \"active\") {\n                        setisSubscribed(true);\n                        setisNewUser(false);\n                        if (doc.data().freeTrial) {\n                          setTrialDetailsState({\n                            endDate: null,\n                            hasEnded: null,\n                          });\n                          updateFreeTrial(null);\n                        }\n                      } else if (element.data().status === \"canceled\") {\n                        setisSubscribed(false);\n                        setisNewUser(false);\n                        setisCanceled(true);\n                      } else {\n                        setisSubscribed(false);\n                        setisNewUser(false);\n                      }\n                    }\n\n                    //if they are subscribed to pos plan\n                    if (element.data().role === \"Pos Software Plan\") {\n                      if (element.data().status === \"active\") {\n                        setisSubscribed(true);\n                        setisNewUser(false);\n                        if (doc.data().freeTrial) {\n                          setTrialDetailsState({\n                            endDate: null,\n                            hasEnded: null,\n                          });\n                          updateFreeTrial(null);\n                        }\n                      } else if (element.data().status === \"canceled\") {\n                        setisSubscribed(false);\n                        setisNewUser(false);\n                        setisCanceled(true);\n                      } else {\n                        setisSubscribed(false);\n                        setisNewUser(false);\n                      }\n                    }\n\n                    //if they are subscribed to online store\n                    if (element.data().role === \"Online Store\") {\n                      if (element.data().status === \"active\") {\n                        setOnlineStoreState({\n                          urlEnding: doc.data().urlEnding,\n                          onlineStoreActive: doc.data().onlineStoreActive,\n                          onlineStoreSetUp: doc.data().onlineStoreSetUp,\n                          stripePublicKey: doc.data().stripePublicKey,\n                          stripeSecretKey: doc.data().stripeSecretKey,\n                          paidStatus: \"active\",\n                        });\n                      } else if (element.data().status === \"canceled\") {\n                        db.collection(\"users\")\n                          .doc(auth.currentUser.uid)\n                          .update({\n                            onlineStoreActive: false,\n                          });\n                        db.collection(\"public\")\n                          .doc(auth.currentUser.uid)\n                          .update({\n                            onlineStoreActive: false,\n                          });\n                        setOnlineStoreState({\n                          urlEnding: doc.data().urlEnding,\n                          onlineStoreActive: false,\n                          onlineStoreSetUp: doc.data().onlineStoreSetUp,\n                          stripePublicKey: doc.data().stripePublicKey,\n                          stripeSecretKey: doc.data().stripeSecretKey,\n                          paidStatus: \"canceled\",\n                        });\n                      } else {\n                        db.collection(\"users\")\n                          .doc(auth.currentUser.uid)\n                          .update({\n                            onlineStoreActive: false,\n                          });\n                        db.collection(\"public\")\n                          .doc(auth.currentUser.uid)\n                          .update({\n                            onlineStoreActive: false,\n                          });\n                        setOnlineStoreState({\n                          urlEnding: doc.data().urlEnding,\n                          onlineStoreActive: false,\n                          onlineStoreSetUp: doc.data().onlineStoreSetUp,\n                          stripePublicKey: doc.data().stripePublicKey,\n                          stripeSecretKey: doc.data().stripeSecretKey,\n                          paidStatus: null,\n                        });\n                      }\n                    }\n                  });\n                  const devicesAmount = docs.docs.filter(\n                    (e) =>\n                      e.data().role === \"Extra Device\" &&\n                      e.data().status === \"active\"\n                  ).length;\n                  extraDevicesPayingFor = devicesAmount;\n                } else if (doc.data().freeTrial) {\n                  setisSubscribed(true);\n                  setisNewUser(false);\n                } else {\n                  setisNewUser(true);\n                  setisSubscribed(false);\n                }\n              })\n              .catch(() =>\n                console.log(\"Error has occured with db extra devices\")\n              );\n\n            doc.ref\n              .collection(\"customers\")\n              .get()\n              .then((docs) => {\n                const newCustomerList = [];\n\n                docs.forEach((element) => {\n                  newCustomerList.push({ ...element.data(), id: element.id });\n                });\n\n                setCustomersList(newCustomerList);\n              })\n              .catch((e) =>\n                console.log(\"Error has occured with db customers: \", e)\n              );\n\n            if (doc.data().freeTrial) {\n              setisNewUser(false);\n              const firstDate = new Date(doc.data().freeTrial.seconds * 1000);\n              const today = new Date();\n              if (firstDate <= today) {\n                setTrialDetailsState({\n                  endDate: doc.data().freeTrial,\n                  hasEnded: true,\n                });\n              } else {\n                setTrialDetailsState({\n                  endDate: doc.data().freeTrial,\n                  hasEnded: false,\n                });\n              }\n            }\n\n            function getCookie(name) {\n              const match = document.cookie.match(\n                new RegExp(\"(^| )\" + name + \"=([^;]+)\")\n              );\n              if (match) return match[2];\n            }\n\n            const deviceID = getCookie(\"deviceID\");\n\n            if (!deviceID) {\n              // Generate a random device ID\n              const yourDeviceID =\n                Math.random().toString(36).substring(2, 15) +\n                Math.random().toString(36).substring(2, 15);\n\n              // Set a cookie\n              document.cookie = `deviceID=${yourDeviceID}; expires=Fri, 31 Dec 9999 23:59:59 GMT; path=/`;\n\n              setDeviceIdState(yourDeviceID);\n            } else {\n              setDeviceIdState(deviceID);\n            }\n\n            doc.ref\n              .collection(\"devices\")\n              .get()\n              .then((docs) => {\n                const devices = [];\n\n                docs.forEach((element) => {\n                  devices.push({ ...element.data(), docID: element.id });\n                  if (element.data().id === deviceID) {\n                    console.log(\"found device: \", element.data());\n                    setMyDeviceDetailsState({\n                      ...element.data(),\n                      docID: element.id,\n                    });\n                  }\n                });\n\n                setDeviceTreeState({ devices: devices, extraDevicesPayingFor });\n              });\n\n            const unsub = db\n              .collection(\"users\")\n              .doc(user.uid)\n              .onSnapshot((doc) => {\n                setUserStoreState({\n                  products: products.sort(customSort),\n                  categories: doc.data().categories\n                    ? doc.data().categories\n                    : [],\n                });\n                if (doc.data().wooCredentials) {\n                  setWoocommerceState(doc.data().wooCredentials);\n                }\n                if (doc.data().storeDetails) {\n                  setStoreDetailState(doc.data().storeDetails);\n                }\n              });\n\n            setloading(false);\n            fadeOut();\n\n            return () => {\n              unsub();\n            };\n          })\n          .catch((e) => console.log(\"Error has occured with db users: \", e));\n      } else {\n        localStorage.removeItem(\"savedUserState\");\n        setUserState(null);\n        setUserStoreState({ products: null, categories: null });\n        setisNewUser(false);\n        setisSubscribed(false);\n        setloading(false);\n      }\n    });\n\n    return () => {\n      unsubscribeAuthStateChanged();\n    };\n  }, [savedUserState]);\n\n  useInterval(() => {\n    if (\n      wooCredentials.useWoocommerce &&\n      isSubscribed &&\n      !isWooError &&\n      myDeviceDetails.printOnlineOrders\n    ) {\n      const WooCommerceAPI = require(\"woocommerce-api\");\n\n      const WooCommerce = new WooCommerceAPI({\n        url: wooCredentials.apiUrl,\n        consumerKey: wooCredentials.ck,\n        consumerSecret: wooCredentials.cs,\n        wpAPI: true,\n        version: \"wc/v3\",\n      });\n\n      let page = 1;\n      let orders = [];\n\n      const getOrders = async () => {\n        const response = await WooCommerce.getAsync(\n          `orders?page=${page}&per_page=100`\n        );\n        const data = JSON.parse(response.body);\n        orders = [...orders, ...data];\n        if (data.length === 100) {\n          page++;\n          getOrders();\n        } else {\n          //console.log(\"WOO ORDERS: \", orders);\n        }\n        // console.log(\"WOO ORDERS: \", orders);\n      };\n\n      getOrders()\n        .then(() => {\n          if (JSON.stringify(orders) === JSON.stringify(wooOrders)) return;\n          for (let index = 0; index < orders.length; index++) {\n            const order = orders[index];\n            let orderIndex;\n            if (wooOrders.length > 0) {\n              orderIndex = wooOrders.findIndex((e) => e.id === order.id);\n            } else {\n              orderIndex = -1;\n            }\n\n            if (orderIndex === -1 || !wooOrders[orderIndex].printed) {\n              if (orderIndex === -1) {\n                db.collection(\"users\")\n                  .doc(userS.uid)\n                  .collection(\"wooOrders\")\n                  .doc(order.id.toString())\n                  .set({ ...order, printed: true })\n                  .then(() => {\n                    setwooOrders((prev) => [\n                      ...prev,\n                      { ...order, printed: true },\n                    ]);\n                    wooOrders.push({ ...order, printed: true });\n                  })\n                  .catch((e) =>\n                    console.log(\n                      \"Error has occured with db wooOrders print: \",\n                      e\n                    )\n                  );\n              } else {\n                db.collection(\"users\")\n                  .doc(userS.uid)\n                  .collection(\"wooOrders\")\n                  .doc(order.id.toString())\n                  .update({ printed: true })\n                  .then(() => {\n                    setwooOrders((prev) => {\n                      const newOrders = [...prev];\n                      newOrders[orderIndex].printed = true;\n                      return newOrders;\n                    });\n                    wooOrders[index].printed = true;\n                  })\n                  .catch((e) =>\n                    console.log(\n                      \"Error has occured with db wooOrder print second if: \",\n                      e\n                    )\n                  );\n              }\n\n              const CleanupOps = (metaList) => {\n                const opsArray = [];\n\n                metaList.forEach((op) => {\n                  const arrContaingMe = opsArray.filter(\n                    (filterOp) => filterOp.key === op.key\n                  );\n\n                  if (arrContaingMe.length > 0) {\n                    opsArray.forEach((opsArrItem, index) => {\n                      if (opsArrItem.key === op.key) {\n                        opsArray[index].vals.push(op.value);\n                      }\n                    });\n                  } else {\n                    opsArray.push({ key: op.key, vals: [op.value] });\n                  }\n                });\n                return opsArray;\n              };\n\n              const printData = [];\n              const dateString = order.date_created;\n              const newDate = new Date(dateString + \"Z\");\n              const targetTimezone =\n                Intl.DateTimeFormat().resolvedOptions().timeZone;\n              const resultDate = tz(newDate)\n                .tz(targetTimezone, true)\n                .format(\"dddd, MMMM Do YYYY, h:mm:ss a z\");\n\n              printData.push(\n                \"\\x1B\" + \"\\x40\", // init\n                \"\\x1B\" + \"\\x61\" + \"\\x31\", // center align\n                storeDetails.name,\n                \"\\x0A\",\n                storeDetails.address?.label + \"\\x0A\",\n                storeDetails.website + \"\\x0A\", // text and line break\n                storeDetails.phoneNumber + \"\\x0A\", // text and line break\n                resultDate + \"\\x0A\",\n                \"\\x0A\",\n                \"Online Order\" + \"\\x0A\", // text and line break\n                `Transaction ID ${order.number}` + \"\\x0A\",\n                \"\\x0A\",\n                \"\\x0A\",\n                \"\\x0A\",\n                \"\\x1B\" + \"\\x61\" + \"\\x30\" // left align\n              );\n\n              order.line_items?.map((cartItem) => {\n                printData.push(\"\\x0A\");\n                printData.push(`Name: ${cartItem.name}`);\n                printData.push(\"\\x0A\");\n                printData.push(`Quantity: ${cartItem.quantity}`);\n                printData.push(\"\\x0A\");\n                printData.push(`Price: $${cartItem.price}`);\n                printData.push(\"\\x0A\");\n\n                if (cartItem.meta) {\n                  CleanupOps(cartItem.meta).map((returnedItem) => {\n                    printData.push(`${returnedItem.key} : `);\n                    printData.push(\"\\x0A\");\n                    returnedItem.vals.map((val, index) => {\n                      printData.push(`${val}`);\n                      printData.push(\"\\x0A\");\n                      if (index >= 0 && index < returnedItem.vals.length - 1) {\n                        printData.push(\", \");\n                      }\n                    });\n                    printData.push(\"\\x0A\");\n                  });\n                } else {\n                  printData.push(\"\\x0A\" + \"\\x0A\");\n                }\n              });\n\n              printData.push(\"\\x0A\");\n              printData.push(\"\\x0A\");\n              printData.push(`Customer Details:`);\n              printData.push(\"\\x0A\");\n              printData.push(`Address: ${order.shipping.address_1}`);\n              printData.push(\"\\x0A\");\n              printData.push(`City: ${order.shipping.city}`);\n              printData.push(\"\\x0A\");\n              printData.push(`Zip/Postal Code: ${order.shipping.postcode}`);\n              printData.push(\"\\x0A\");\n              printData.push(`Province/State: ${order.shipping.state}`);\n              printData.push(\"\\x0A\");\n              printData.push(\n                `Name: ${order.shipping.first_name} ${order.shipping.last_name}`\n              );\n              printData.push(\"\\x0A\");\n              printData.push(`Phone Number: ${order.billing.phone}`);\n              printData.push(\"\\x0A\");\n              order.shipping_lines.map((line) => {\n                printData.push(`Shipping Method: ${line.method_title}`);\n                printData.push(\"\\x0A\");\n              });\n              if (order.customer_note) {\n                printData.push(`Customer Note: ${order.customer_note}`);\n                printData.push(\"\\x0A\");\n              }\n              printData.push(\"\\x0A\");\n              printData.push(\"\\x0A\");\n\n              printData.push(\n                \"\\x0A\",\n                \"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX\" + \"\\x0A\",\n                \"\\x0A\" + \"\\x0A\",\n                \"Payment Method: \" +\n                  order.payment_method_title +\n                  \"\\x0A\" +\n                  \"\\x0A\",\n                `Total Including (${\n                  storeDetails.taxRate ? storeDetails.taxRate : \"13\"\n                }% Tax): ` +\n                  \"$\" +\n                  order.total +\n                  \"\\x0A\" +\n                  \"\\x0A\",\n                \"------------------------------------------\" + \"\\x0A\",\n                \"\\x0A\", // line break\n                \"\\x0A\", // line break\n                \"\\x0A\", // line break\n                \"\\x0A\", // line break\n                \"\\x0A\", // line break\n                \"\\x0A\" // line break\n              );\n\n              printData.push(\"\\x1D\" + \"\\x56\" + \"\\x00\");\n\n              const doublePrint = printData.concat(printData);\n\n              qz.websocket\n                .connect()\n                .then(function () {\n                  const config = qz.configs.create(\n                    myDeviceDetails.printToPrinter\n                  );\n                  return qz.print(config, doublePrint);\n                })\n                .then(qz.websocket.disconnect)\n                .catch(function (err) {\n                  // console.error(err);\n                  alert(\n                    \"An error occured while trying to print. Try refreshing the page and trying again.\"\n                  );\n                });\n            }\n          }\n        })\n        .catch((e) => {\n          console.log(\"Error has occured when trying to get WooOrders: \", e);\n          alert(\n            \"There was an error connecting to your woocommerce store. Please refresh the page to try again.\"\n          );\n          setisWooError(true);\n        });\n    }\n  }, 10000);\n\n  const fadeIn = () => {\n    // Will change fadeAnim value to 0 in 3 seconds\n    Animated.timing(fadeAnim, {\n      toValue: 1,\n      duration: 500,\n      useNativeDriver: false,\n    }).start();\n  };\n\n  const fadeOut = () => {\n    // Will change fadeAnim value to 0 in 3 seconds\n    Animated.timing(fadeAnim, {\n      toValue: 0,\n      duration: 500,\n      useNativeDriver: false,\n    }).start(() => setviewVisible(false));\n  };\n\n  const resetLoader = () => {\n    setviewVisible(true);\n    fadeIn();\n  };\n\n  const NavigationContent = () => {\n    return (\n      <>\n        {isSubscribed && <Route path=\"/\" component={AuthRoute} />}\n        {trialDetails.hasEnded && <TrialEnded resetLoader={resetLoader} />}\n        {isNewUser && <NewUserPayment resetLoader={resetLoader} />}\n        {isCanceled && !isSubscribed && !isNewUser && (\n          <PaymentUpdateNotification\n            resetLoader={resetLoader}\n            isCanceled={isCanceled}\n          />\n        )}\n      </>\n    );\n  };\n\n  return (\n    <Router>\n      <ScrollToTop />\n      <Switch>\n        {userS && (\n          <>\n            <NavigationContent />\n            {viewVisible && (\n              <Animated.View\n                style={{\n                  alignItems: \"center\",\n                  justifyContent: \"center\",\n                  backgroundColor: \"white\",\n                  position: \"absolute\",\n                  opacity: fadeAnim,\n                  height: \"100%\",\n                  width: \"100%\",\n                }}\n              >\n                <Image\n                  source={require(\"assets/loading.gif\")}\n                  // source={require(\"assets/divinepos-loading.gif\")}\n                  style={{ width: 450, height: 450, resizeMode: \"contain\" }}\n                />\n              </Animated.View>\n            )}\n          </>\n        )}\n        {!userS && !loading && <Route path=\"/\" component={NonAuthRoute} />}\n      </Switch>\n    </Router>\n  );\n};\n\nexport default RouteManager;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}